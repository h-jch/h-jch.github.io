<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>JavaWeb技术原理 | Kei's Blog</title><meta name=keywords content="java,servlet,web"><meta name=description content="最近在重温JavaWeb的内容，特此记录一下。 1 基本概念 1.1 前言 web开发： 静态web html，css 提供给所有人看的数据始终不会变化 动态we"><meta name=author content="kei"><link rel=canonical href=https://h-jch.github.io/posts/code/javaweb/><link crossorigin=anonymous href=/assets/css/stylesheet.678b5c47efa744d2e0dd0d61101075e6aecdc9a0631e7ad8538f4ec0cca79273.css integrity="sha256-Z4tcR++nRNLg3Q1hEBB15q7NyaBjHnrYU49OwMynknM=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://h-jch.github.io/images/avatar.png><link rel=icon type=image/png sizes=16x16 href=https://h-jch.github.io/images/avatar.png><link rel=icon type=image/png sizes=32x32 href=https://h-jch.github.io/images/avatar.png><link rel=apple-touch-icon href=https://h-jch.github.io/images/avatar.png><link rel=mask-icon href=https://h-jch.github.io/images/avatar.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="JavaWeb技术原理"><meta property="og:description" content="最近在重温JavaWeb的内容，特此记录一下。 1 基本概念 1.1 前言 web开发： 静态web html，css 提供给所有人看的数据始终不会变化 动态we"><meta property="og:type" content="article"><meta property="og:url" content="https://h-jch.github.io/posts/code/javaweb/"><meta property="og:image" content="https://h-jch.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-07-06T21:07:03+08:00"><meta property="article:modified_time" content="2020-07-06T21:07:03+08:00"><meta property="og:site_name" content="Kei's Blog"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://h-jch.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="JavaWeb技术原理"><meta name=twitter:description content="最近在重温JavaWeb的内容，特此记录一下。 1 基本概念 1.1 前言 web开发： 静态web html，css 提供给所有人看的数据始终不会变化 动态we"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://h-jch.github.io/posts/"},{"@type":"ListItem","position":3,"name":"JavaWeb技术原理","item":"https://h-jch.github.io/posts/code/javaweb/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"JavaWeb技术原理","name":"JavaWeb技术原理","description":"最近在重温JavaWeb的内容，特此记录一下。 1 基本概念 1.1 前言 web开发： 静态web html，css 提供给所有人看的数据始终不会变化 动态we","keywords":["java","servlet","web"],"articleBody":"最近在重温JavaWeb的内容，特此记录一下。\n1 基本概念 1.1 前言 web开发：\n静态web html，css 提供给所有人看的数据始终不会变化 动态web 几乎所有网站，淘宝 提供给所有人看的数据始终会发生变化，每个人在不同的时间、不同的地点看到的信息各不相同 servlet/jsp，asp，php 1.2 web应用程序 可以提供浏览器访问的程序\na.html、b.html等多个web资源，这些web资源可以被外界访问，对外界提供服务 能访问到的任何一个页面或者资源，都存在于世界某个地方的计算机上 url 统一的web资源会被放在同一个文件夹下，web应用程序—\u003eTomcat服务器 一个web应用有多个部分组成（静态web、动态web） html，css，js jsp，servlet Java程序 jar包 配置文件（properties，xml） web应用程序编写完后，若想要提供给外部访问，需要一个服务器来统一管理 1.3 静态web *.html，*.html这些都是网站的资源，如果服务器上一直存在这些资源，我们就可以直接进行读取，需要网络\n静态web的缺点\nweb页面无法动态更新，所有用户看到的都是一个页面 轮播图，点击特效：伪动态 JavaScript 无法和数据库交互（数据无法持久化，用户无法交互） 1.4 动态web 页面会动态展示，web页面的展示效果因人而异 动态web的缺点\n如果服务器的动态web资源出现了错误，需要重新编写后台程序，重新发布 停机维护 动态web的优点\nweb页面可以动态更新，所有用户看到的不是同一个页面\n可以与数据库交互\n2 Web服务器 2.1 技术讲解 ASP 微软：国内最早流行的就是ASP 在html中嵌入了VB的脚本，ASP+COM 在ASP开发中，基本一个页面有几千行的业务代码，页面混乱 维护成本高 C# IIS PHP php开发速度很快，功能强大，跨平台，代码简单 无法承载大访问量的情况 servlet/jsp sun公司主推的B/S架构 基于Java语言 可以承载三高问题带来的影响 语法像ASP 2.2 web服务器 服务器是一种被动的操作，用来处理用户的一些请求和给用户一些响应信息\nIIS，微软的 Tomcat 3 Tomcat 3.1 安装Tomcat 3.2 Tomcat启动 3.3 Tomcat配置 网站是如何进行访问的\n输入一个域名，回车 检查本机的hosts配置文件内是否存在域名映射 有：直接访问对应的ip地址，找到需要访问的web程序，可以直接访问 没有：去DNS服务器找对应的ip地址，找到则返回 3.4 发布web网站 将自己写的网站，放到服务器（Tomcat）指定的web应用的文件夹（webapps）下，就可以访问了\n网站应有的架构\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 --webapps ：Tomcat服务器的web目录 -ROOT -testweb ：网站的目录名 - WEB-INF -classes : java程序 -lib：web应用所依赖的jar包 -web.xml ：网站配置文件 - index.html 默认的首页 - static -css -style.css -js -img -..... 4 HTTP 4.1 什么是HTTP 超文本传输协议是一个简单的请求-响应协议，通常运行在TCP之上\n文本：html，字符串，…… 超文本：图片，音乐，视频，定位，地图，…… 端口：80 HTTPS：安全的\n4.2 两个版本 http 1.0 HTTP/1.0：客户端与web服务器连接后，只能获得一个web资源 http 2.0 HTTP/2.0：客户端与web服务器连接后，可以获得多个web资源 4.3 HTTP请求 客户端—request—服务器 1 2 3 4 5 6 7 8 9 10 Request URL:https://www.baidu.com/ 请求地址 Request Method:GET get方法/post方法 Status Code:200 OK 状态码：200 Remote（远程） Address:14.215.177.39:443 Accept:text/html Accept-Encoding:gzip, deflate, br Accept-Language:zh-CN,zh;q=0.9 语言 Cache-Control:max-age=0 Connection:keep-alive 请求行 请求行中的请求方式：GET 请求方式：GET，POST，HEAD，DELETE，PUT，TRACT，…… GET：请求能够携带的参数比较少，大小有限制，会在浏览器的URL地址栏显示数据内容，不安全，但高效 POST：请求能够携带的参数没有限制，大小没有限制，不会在浏览器的URL地址栏显示数据内容，安全，但不高效 消息头 1 2 3 4 5 6 Accept:告诉浏览器支持的数据类型 Accept-Encoding:支持哪种编码格式 GBK\tUTF-8\tGB2312\tISO8859-1 Accept-Language:告诉浏览器语言环境 Cache-Control:缓存控制 Connection:告诉浏览器请求完成是断开还是保持连接 HOST：主机 4.4 HTTP响应 服务器—response—客户端 响应体 1 2 3 4 5 6 7 8 Accept：告诉浏览器支持的数据类型 Accept-Encoding：支持哪种编码格式 GBK UTF-8 GB2312 ISO8859-1 Accept-Language：告诉浏览器语言环境 Cache-Control：缓存控制 Connection：告诉浏览器请求完成是断开还是保持连接 HOST：主机 Refresh：告诉客户端，多久刷新一次 Location：让网页重新定位 响应状态码 200：请求响应成功 3xx：请求重定向 4xx：找不到资源404 5xx：服务器代码错误500，502：网关错误 5 Maven 在JavaWeb开发中，需要使用大量的jar包，手动导入很繁琐，如何自动导入和配置jar包\n5.1 项目架构管理工具 Maven的核心思想：约定大于配置。Maven会规定如何编写Java代码\n5.2 下载安装Maven 5.3 配置环境变量 5.4 配置阿里云镜像 6 Servlet 6.1 Servlet简介 Servlet是sun公司开发动态web的一门技术 sun在这些api中提供一个接口叫做Servlet，如果想开发一个Servlet程序，只需要 编写一个类，实现Servlet接口 把开发好的Java类部署到服务器中 把实现了Servlet接口的Java程序叫做Servlet 6.2 HelloServlet 构建一个普通的Maven项目\n编写一个Serlvet程序\n编写一个普通类 实现Servlet接口，这里直接继承HttpServlet 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 public class HelloServlet extends HttpServlet { //由于get或者post只是请求实现的不同的方式，可以相互调用，业务逻辑都一样； @Override protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException { //ServletOutputStream outputStream = resp.getOutputStream(); PrintWriter writer = resp.getWriter(); //响应流 writer.print(\"Hello,Serlvet\"); } @Override protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException { doGet(req, resp); } } 编写Servlet的映射\n为什么需要映射，我们写的是Java程序，但是要通过浏览器访问，而浏览器需要连接web服务器，所以我们需要在web服务中注册我们写的Servlet，还需要定义一个浏览器能够访问的路径\n1 2 3 4 5 6 7 8 9 10 hello com.hjc.servlet.HelloServlet hello /hello 配置Tomcat\n启动测试\n6.3 Servlet原理 Servlet是由web服务器在收到浏览器请求后调用\n6.4 Mapping问题 一个servlet可以指定一个映射路径 1 2 3 4 hello /hello 一个servlet可以指定多个映射路径 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 hello /hello hello /hello2 hello /hello3 hello /hello4 hello /hello5 一个servlet可以指定通用映射路径 1 2 3 4 hello /hello/* 默认请求路径 1 2 3 4 5 hello /* 指定一些后缀或者前缀 1 2 3 4 5 6 7 8 hello *.do 优先级问题 指定了固有的映射路径优先级最高，如果找不到就会走默认的处理请求\n1 2 3 4 5 6 7 8 9 error com.hjc.servlet.ErrorServlet error /* 6.5 ServletContext web容器在启动的时候，它会为每个web程序都创建一个对应的ServletContext对象，代表当前的web应用\n1. 共享数据 在一个servlet中保存的数据，可以在另一个servlet中得到\n1 2 3 4 5 6 7 8 9 10 11 12 13 public class HelloServlet extends HttpServlet { @Override protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException { //this.getInitParameter() 初始化参数 //this.getServletConfig() Servlet配置 //this.getServletContext() Servlet上下文 ServletContext context = this.getServletContext(); String username = \"hjc\"; //数据 context.setAttribute(\"username\",username); //将一个数据保存在了ServletContext中，名字为username，值为username } } 1 2 3 4 5 6 7 8 9 10 11 public class GetServlet extends HttpServlet { @Override protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException { ServletContext context = this.getServletContext(); String username = (String) context.getAttribute(\"username\"); resp.setContentType(\"text/html\"); resp.setCharacterEncoding(\"utf-8\"); resp.getWriter().print(\"名字\"+username); } } 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 hello com.hjc.servlet.HelloServlet hello /hello get com.hjc.servlet.GetServlet get /get 2. 获取初始化参数 1 2 3 4 5 url jdbc:mysql://localhost:3306/mybatis 1 2 3 4 5 6 7 8 9 public class HelloServlet extends HttpServlet { @Override protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException { ServletContext context = this.getServletContext(); String url = context.getInitParameter(\"url\"); resp.getWriter().print(url); } } 3. 请求转发 1 2 3 4 5 6 7 8 public class HelloServlet extends HttpServlet { @Override protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException { ServletContext context = this.getServletContext(); context.getRequestDispatcher(\"/gp\").forward(req, resp);\t// gp为转发路径 } } 4. 读取资源文件 Properties\n在java目录下新建properties 在resources目录下新建properties 1 2 username=root password=123456 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 public class ServletDemo extends HttpServlet { @Override protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException { InputStream is = this.getServletContext() .getResourceAsStream(\"/WEB-INF/classes/com/hjc/servlet/test.properties\"); Properties prop = new Properties(); prop.load(is); String user = prop.getProperty(\"username\"); String pwd = prop.getProperty(\"password\"); resp.getWriter().print(user+\":\"+pwd); } @Override protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException { doGet(req, resp); } } 6.6 HttpServletResponse web服务器接收到客户端的http请求，针对这个请求，分别创建一个代表请求的HttpServletRequest对象和代表相应的HttpServletResponse对象 如果要获取客户端请求过来的参数，找HttpServletRequest 如果要给客户端响应一些信息，找HttpServletResponse 1. 简单分类 负责向浏览器发送数据的方法\n1 2 servletOutputstream getOutputstream() throws IOException; Printwriter getwriter() throws IOException; 负责向浏览器发送响应头的方法\n1 2 3 4 5 6 7 8 9 10 void setCharacterEncoding(String var1)； void setContentLength(int var1)； void setContentLengthLong(long var1); void setContentType(String var1)； void setDateHeader(String varl,long var2) void addDateHeader(String var1,long var2) void setHeader(String var1,String var2); void addHeader(String var1,String var2)； void setIntHeader(String var1,int var2); void addIntHeader(String varl,int var2); 2. 下载文件 向浏览器输出消息 下载文件 获取下载文件的路径 获取下载文件的文件名 设置让浏览器支持下载需要的东西 获取下载文件的输入流 创建缓冲区 获取OutputStream对象 将FileOutputStream流写入到buffer缓冲区 使用OutputStream将缓冲区内的数据输出到客户端 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 @Override protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException { // 1. 要获取下载文件的路径 String realPath = path;\t//路径 System.out.println(\"下载文件的路径：\"+realPath); // 2. 下载的文件名是啥？ String fileName = realPath.substring(realPath.lastIndexOf(\"\\\\\") + 1); // 3. 设置想办法让浏览器能够支持(Content-Disposition)下载我们需要的东西,中文文件名URLEncoder.encode编码，否则有可能乱码 resp.setHeader(\"Content-Disposition\",\"attachment;filename=\"+URLEncoder.encode(fileName,\"UTF-8\")); // 4. 获取下载文件的输入流 FileInputStream in = new FileInputStream(realPath); // 5. 创建缓冲区 int len = 0; byte[] buffer = new byte[1024]; // 6. 获取OutputStream对象 ServletOutputStream out = resp.getOutputStream(); // 7. 将FileOutputStream流写入到buffer缓冲区,使用OutputStream将缓冲区中的数据输出到客户端！ while ((len=in.read(buffer))\u003e0){ out.write(buffer,0,len); } in.close(); out.close(); } 3. 验证码功能 验证码实现\n前端实现 后端实现，需要用到Java的图片类，生产一个图片 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 public class ImageServlet extends HttpServlet { @Override protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException { //如何让浏览器3秒自动刷新一次; resp.setHeader(\"refresh\",\"3\"); //在内存中创建一个图片 BufferedImage image = new BufferedImage(80,20,BufferedImage.TYPE_INT_RGB); //得到图片 Graphics2D g = (Graphics2D) image.getGraphics(); //笔 //设置图片的背景颜色 g.setColor(Color.white); g.fillRect(0,0,80,20); //给图片写数据 g.setColor(Color.BLUE); g.setFont(new Font(null,Font.BOLD,20)); g.drawString(makeNum(),0,20); //告诉浏览器，这个请求用图片的方式打开 resp.setContentType(\"image/jpeg\"); //网站存在缓存，不让浏览器缓存 resp.setDateHeader(\"expires\",-1); resp.setHeader(\"Cache-Control\",\"no-cache\"); resp.setHeader(\"Pragma\",\"no-cache\"); //把图片写给浏览器 ImageIO.write(image,\"jpg\", resp.getOutputStream()); } //生成随机数 private String makeNum(){ Random random = new Random(); String num = random.nextInt(9999999) + \"\"; StringBuffer sb = new StringBuffer(); for (int i = 0; i \u003c 7-num.length() ; i++) { sb.append(\"0\"); } num = sb.toString() + num; return num; } @Override protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException { doGet(req, resp); } } 1 2 3 4 5 6 7 8 ImageServlet com.hjc.servlet.ImageServlet ImageServlet /img 4. 实现重定向 1 void sendRedirect(String var1) throws IOException; 常见场景\n用户登录 1 2 3 4 5 6 7 8 9 10 @Override protected void doGet(HttpservletRequest req, HttpservletResponse resp) throws ServletException, IOException { resp.sendRedirect(\"/r/img\");//重定向 /* resp.setHeader(\"Location\",\"/r/img\"); resp.setstatus(302); */ } 测试\nindex.jsp\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 Hel1o World! \u003c%--这里超交的路径,需要寻找到项目的路径--%\u003e \u003c%--${pageContext.request.contextPath}代表当前的项目--%\u003e 用户名: 密码: RequestTest.java\n1 2 3 4 5 6 7 8 9 10 11 12 public class RequestTest extends HttpServlet { @Override protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException { //处理方求 String username = req.getParameter(\"username\"); String password rea.getParameter(\"password\"); System.out.println(username+\":\"+password); resp.sendRedirect(\"/r/success.jsp\"); } success.jsp\n1 2 3 4 5 6 7 8 9 \u003c%@ page contentType=\"text/html; charset=UTF-8\" language=\"java\" %\u003e Title success web.xml配置\n1 2 3 4 5 6 7 8 requset com.hjc.servlet.RequestTest requset /login 6.7 HttpServletRequest HttpServletRequest代表客户端的请求，用户通过Http协议访问服务器，Http请求中的所有信息都会被封装到HttpServletRequest，通过这个HttpServletRequest的方法获得客户端的所有信息\n1. 获取参数 2. 请求转发 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 @Override protected void doGet(HttpservletRequest req. HttpservletResponse resp) throws ServletException, IOException { req.setcharacterEncoding(\"utf-8\"); resp.setcharacterEncoding(\"utf-8\"); String username = req.getParameter(\"username\"); String password = req.getParameter(\"password\"); String[] hobbies = req.getParameterValues(\"hobbys\"); System.out.println(\"==========\"); //后台接收中文乱码问题 System.out.println(username); System.out.println(password); System.out.println(Arrays.tostring(hobbys)); System.out.println(\"============\"); system.out.println(req.getContextPath()); //通过请求转发 //这里的/代表当前的web应用 req.getRequestDispatcher(\"/success.jsp\").forward(req,resp); } 重定向和和请求转发的区别 相同点 页面都会实现跳转 不同点 请求转发的时候，url不会发生变化，是同一个请求 重定向的时候，url会发生变化，是不同请求 7 Cookie、Session 7.1 会话 会话：用户打开一个浏览器，点击多个超链接，访问多个web资源，关闭浏览器，这个过程可以称为会话\n有状态会话：一个同学来过教室，下次再来教室，我们会知道这个同学，曾经来过，称为有状态会话\n7.2 保存会话的两种技术 那么，一个网站，如何证明访问过\n客户端 cookie 服务端给客户端一个信件，客户端下次访问服务器带上信件就可以了 服务端 session 服务器登记访问过，下次访问的时候匹配登记信息 常见情况：网站登录后，下次访问不用再次登录\n7.3 Cookie 从请求中拿到cookie信息 服务器响应给客户端cookie 1 2 3 4 5 6 Cookie[] cookies = req.getCookies(); //获得Cookie cookie.getName(); //获得cookie中的key cookie.getValue(); //获得cookie中的vlaue new Cookie(\"lastLoginTime\", System.currentTimeMillis()+\"\"); //新建一个cookie cookie.setMaxAge(24*60*60); //设置cookie的有效期 resp.addCookie(cookie); //响应给客户端一个cookie cookie一般会保存在本地的用户目录下appdata\n一个网站的cookie存在上限\n一个cookie只能保存一个信息 一个web站点可以给浏览器发送多个cookie，最多存放20个 cookie大小有限制 4kb 浏览器有cookie上限 300个 删除cookie 自动删除 不设置有效期，关闭浏览器，自动失效 设置有效时间为0 手动删除 7.4 Session（重要） 服务器会给每个用户（浏览器）创建一个Session对象 一个Session独占一个浏览器，只要浏览器没有关闭，这个Session就存在 用户登录后，整个网站都可以访问 保存用户信息 保存购物车信息 Session和Cookie的区别\nCookie是把用户的数据写给用户的浏览器，浏览器保存 Session是把用户的数据写到用户独占的Session中，服务器保存 使用Session 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 public class SessionDemo extends HttpServlet { @Override protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException { //解决乱码问题 req.setCharacterEncoding(\"UTF-8\"); resp.setCharacterEncoding(\"UTF-8\"); resp.setContentType(\"text/html;charset=utf-8\"); //得到Session HttpSession session = req.getSession(); //给Session中存东西 session.setAttribute(\"name\",new Person(\"admin\",1)); //获取Session的ID String sessionId = session.getId(); //判断Session是不是新创建 if (session.isNew()){ resp.getWriter().write(\"session创建成功,ID:\"+sessionId); }else { resp.getWriter().write(\"session以及在服务器中存在了,ID:\"+sessionId); } //Session创建的时候做了什么事情； //Cookie cookie = new Cookie(\"JSESSIONID\",sessionId); //resp.addCookie(cookie); } @Override protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException { doGet(req, resp); } } 得到Session 1 2 3 4 5 6 //得到Session HttpSession session = req.getSession(); Person person = (Person) session.getAttribute(\"name\"); System.out.println(person.toString()); 注销Session 手动注销 1 2 3 4 HttpSession session = req.getSession(); session.removeAttribute(\"name\"); //手动注销Session session.invalidate(); 自动注销（会话自动过期） 1 2 3 4 5 15 8 JSP（不重要） 8.1 什么是JSP Java Server Pages：Java服务器端页面，和Servlet一样，用于动态Web技术\n最大的特点\n写JSP就像在写HTML 区别 HTML只给用户提供静态的数据 JSP页面中可以嵌入Java代码，为用户提供动态数据 8.2 JSP原理 JSP本质上就是一个Servlet，浏览器向服务器发送请求，不管访问什么资源，其实都是在访问Servlet\n1 2 3 4 5 6 //初始化 public void _jspInit() {} //销毁 public void _jspDestroy() {} //JSPService public void _jspService(HttpServletRequest request, HttpServletResponse response) {} 略 9 JavaBean 实体类\nJavaBean有特定的写法\n必须要有一个无参构造函数 属性必须私有化 必须有对应的get/set方法 一般用来和数据库的字段做映射 ORM\nORM：对象关系映射 表 —\u003e 类 字段 —\u003e 属性 行记录 —\u003e 对象 10 MVC三层架构 MVC：Model、View、Controller 模型、视图、控制器\n10.1 以前的架构 用户直接访问控制层，控制层就可以直接操作数据库\n1 2 3 4 5 6 7 8 9 10 servlet--CRUD--\u003e数据库 弊端：程序十分臃肿，不利于维护 servlet的代码中：处理请求、响应、视图跳转、处理JDBC、处理业务代码、处理逻辑代码 架构：没有什么是加一层解决不了的！ 程序猿调用 ↑ JDBC （实现该接口） ↑ Mysql/Oracle/SqlServer ....（不同厂商） 10.2 MVC三层架构 Model\n业务处理：实现业务逻辑（Service） 数据持久层：CRUD（Dao - 数据持久化对象） View\n展示数据 提供链接发起Servlet请求（a、form、img …） Controller（Servlet）\n接收用户的请求（req：请求参数、Session信息） 交给业务层处理对应的代码 控制视图的跳转 1 2 3 登录 ---\u003e 接收用户的登录请求 ---\u003e 处理用户的请求（获取用户登录的参数，username，password） ---\u003e 交给业务层处理登录业务（判断用户名密码是否正确：事务） ---\u003e Dao层查询用户名和密码是否正确 ---\u003e 数据库 11 Filter（重要） 过滤器，用来过滤网站的数据\n处理中文乱码 登陆验证 Filter开发步骤\n导包\n编写过滤器\n实现Filter接口，重写对应方法 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 public class CharacterEncodingFilter implements Filter { //初始化：web服务器启动，就以及初始化了，随时等待过滤对象出现！ public void init(FilterConfig filterConfig) throws ServletException { System.out.println(\"CharacterEncodingFilter初始化\"); } //Chain : 链 /* 1. 过滤中的所有代码，在过滤特定请求的时候都会执行 2. 必须要让过滤器继续同行 chain.doFilter(request,response); */ public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain) throws IOException, ServletException { request.setCharacterEncoding(\"utf-8\"); response.setCharacterEncoding(\"utf-8\"); response.setContentType(\"text/html;charset=UTF-8\"); System.out.println(\"CharacterEncodingFilter执行前....\"); chain.doFilter(request,response); //让请求继续走，如果不写，程序到这里就被拦截停止！ System.out.println(\"CharacterEncodingFilter执行后....\"); } //销毁：web服务器关闭的时候，过滤器会销毁 public void destroy() { System.out.println(\"CharacterEncodingFilter销毁\"); } } 在web.xml中配置Filter 1 2 3 4 5 6 7 8 9 10 11 CharacterEncodingFilter com.hjc.filter.CharacterEncodingFilter CharacterEncodingFilter /servlet/* 12 监听器 实现一个监听器的接口（有n种监听器）\n编写一个监听器\n实现监听器的接口 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 //统计网站在线人数 ： 统计session public class OnlineCountListener implements HttpSessionListener { //创建session监听： 看你的一举一动 //一旦创建Session就会触发一次这个事件！ public void sessionCreated(HttpSessionEvent se) { ServletContext ctx = se.getSession().getServletContext(); System.out.println(se.getSession().getId()); Integer onlineCount = (Integer) ctx.getAttribute(\"OnlineCount\"); if (onlineCount==null){ onlineCount = new Integer(1); }else { int count = onlineCount.intValue(); onlineCount = new Integer(count+1); } ctx.setAttribute(\"OnlineCount\",onlineCount); } //销毁session监听 //一旦销毁Session就会触发一次这个事件！ public void sessionDestroyed(HttpSessionEvent se) { ServletContext ctx = se.getSession().getServletContext(); Integer onlineCount = (Integer) ctx.getAttribute(\"OnlineCount\"); if (onlineCount==null){ onlineCount = new Integer(0); }else { int count = onlineCount.intValue(); onlineCount = new Integer(count-1); } ctx.setAttribute(\"OnlineCount\",onlineCount); } /* Session销毁： 1. 手动销毁 getSession().invalidate(); 2. 自动销毁 */ } 在web.xml中注册监听器\n1 2 3 4 com.hjc.listener.OnlineCountListener 13 过滤器、监听器常见应用 13.1 监听器 GUI编程中常用\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 public class TestPanel { public static void main(String[] args) { Frame frame = new Frame(\"Test\"); //新建一个窗体 Panel panel = new Panel(null); //面板 frame.setLayout(null); //设置窗体的布局 frame.setBounds(300,300,500,500); frame.setBackground(new Color(0,0,255)); //设置背景颜色 panel.setBounds(50,50,300,300); panel.setBackground(new Color(0,255,0)); //设置背景颜色 frame.add(panel); frame.setVisible(true); //监听事件，监听关闭事件 frame.addWindowListener(new WindowAdapter() { @Override public void windowClosing(WindowEvent e) { super.windowClosing(e); } }); } } 13.2 过滤器 用户登陆后才能进入主页，用户注销后就不能进入主页\n用户登录后，向Session中放入用户的数据 进入主页的时候要判断用户是否已经登陆，在过滤器中实现 1 2 3 4 5 6 7 8 9 10 11 12 public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain) throws IOException, ServletException { HttpServletRequest request = (HttpServletRequest) req; HttpServletResponse response = (HttpServletResponse) resp; if (request.getSession().getAttribute(Constant.USER_SESSION)==null){ response.sendRedirect(\"/error.jsp\"); } chain.doFilter(request,response); } 14 JDBC 14.1 JDBC固定步骤 加载驱动 连接数据库 向数据库发送sql的对象Statement：CRUD 编写sql 执行sql 关闭连接（注意先后顺序） 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 public class TestJDBC { public static void main(String[] args) throws ClassNotFoundException, SQLException { //配置信息 //useUnicode=true\u0026characterEncoding=utf-8 解决中文乱码 String url=\"jdbc:mysql://localhost:3306/jdbc?useUnicode=true\u0026characterEncoding=utf-8\"; String username = \"root\"; String password = \"123456\"; //1.加载驱动 Class.forName(\"com.mysql.jdbc.Driver\"); //2.连接数据库,代表数据库 Connection connection = DriverManager.getConnection(url, username, password); //3.向数据库发送SQL的对象Statement,PreparedStatement : CRUD Statement statement = connection.createStatement(); //4.编写SQL String sql = \"select * from users\"; //5.执行查询SQL，返回一个 ResultSet ： 结果集 ResultSet rs = statement.executeQuery(sql); while (rs.next()){ System.out.println(\"id=\"+rs.getObject(\"id\")); System.out.println(\"name=\"+rs.getObject(\"name\")); System.out.println(\"password=\"+rs.getObject(\"password\")); System.out.println(\"email=\"+rs.getObject(\"email\")); System.out.println(\"birthday=\"+rs.getObject(\"birthday\")); } //6.关闭连接，释放资源（一定要做） 先开后关 rs.close(); statement.close(); connection.close(); } } 预编译sql\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 public class TestJDBC2 { public static void main(String[] args) throws Exception { //配置信息 //useUnicode=true\u0026characterEncoding=utf-8 解决中文乱码 String url=\"jdbc:mysql://localhost:3306/jdbc?useUnicode=true\u0026characterEncoding=utf-8\"; String username = \"root\"; String password = \"123456\"; //1.加载驱动 Class.forName(\"com.mysql.jdbc.Driver\"); //2.连接数据库,代表数据库 Connection connection = DriverManager.getConnection(url, username, password); //3.编写SQL String sql = \"insert into users(id, name, password, email, birthday) values (?,?,?,?,?);\"; //4.预编译 PreparedStatement preparedStatement = connection.prepareStatement(sql); preparedStatement.setInt(1,1);//给第一个占位符？的值赋值为1 preparedStatement.setString(2,\"admin\");//给第二个占位符？的值赋值为admin preparedStatement.setString(3,\"123456\");//给第三个占位符？的值赋值为123456 preparedStatement.setString(4,\"admin@gmail.com\");//给第四个占位符？的值赋值为admin@gmail.com preparedStatement.setDate(5,new Date(new java.util.Date().getTime())); //给第五个占位符？的值赋值为new Date(new java.util.Date().getTime()) //5.执行SQL int i = preparedStatement.executeUpdate(); if (i\u003e0){ System.out.println(\"插入成功@\"); } //6.关闭连接，释放资源（一定要做） 先开后关 preparedStatement.close(); connection.close(); } } 14.2 事务 要么都成功，要么都失败，ACID原则：保证数据的安全\n","wordCount":"8994","inLanguage":"en","datePublished":"2020-07-06T21:07:03+08:00","dateModified":"2020-07-06T21:07:03+08:00","author":[{"@type":"Person","name":"kei"}],"mainEntityOfPage":{"@type":"WebPage","@id":"https://h-jch.github.io/posts/code/javaweb/"},"publisher":{"@type":"Organization","name":"Kei's Blog","logo":{"@type":"ImageObject","url":"https://h-jch.github.io/images/avatar.png"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://h-jch.github.io accesskey=h title="Kei's Blog (Alt + H)"><img src=https://h-jch.github.io/images/avatar.png alt aria-label=logo height=35>Kei's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://h-jch.github.io/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://h-jch.github.io/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://h-jch.github.io/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://h-jch.github.io/about/ title=About><span>About</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>JavaWeb技术原理</h1><div class=post-meta><span title='2020-07-06 21:07:03 +0800 CST'>2020-07-06</span>&nbsp;·&nbsp;18 min&nbsp;·&nbsp;8994 words&nbsp;·&nbsp;kei</div></header><aside id=toc-container class="toc-container wide"><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#1-%e5%9f%ba%e6%9c%ac%e6%a6%82%e5%bf%b5 aria-label="1 基本概念">1 基本概念</a><ul><li><a href=#11-%e5%89%8d%e8%a8%80 aria-label="1.1 前言">1.1 前言</a></li><li><a href=#12-web%e5%ba%94%e7%94%a8%e7%a8%8b%e5%ba%8f aria-label="1.2 web应用程序">1.2 web应用程序</a></li><li><a href=#13-%e9%9d%99%e6%80%81web aria-label="1.3 静态web">1.3 静态web</a></li><li><a href=#14-%e5%8a%a8%e6%80%81web aria-label="1.4 动态web">1.4 动态web</a></li></ul></li><li><a href=#2-web%e6%9c%8d%e5%8a%a1%e5%99%a8 aria-label="2 Web服务器">2 Web服务器</a><ul><li><a href=#21-%e6%8a%80%e6%9c%af%e8%ae%b2%e8%a7%a3 aria-label="2.1 技术讲解">2.1 技术讲解</a><ul><li><a href=#asp aria-label=ASP>ASP</a></li><li><a href=#php aria-label=PHP>PHP</a></li><li><a href=#servletjsp aria-label=servlet/jsp>servlet/jsp</a></li></ul></li><li><a href=#22-web%e6%9c%8d%e5%8a%a1%e5%99%a8 aria-label="2.2 web服务器">2.2 web服务器</a></li></ul></li><li><a href=#3-tomcat aria-label="3 Tomcat">3 Tomcat</a><ul><li><a href=#31-%e5%ae%89%e8%a3%85tomcat aria-label="3.1 安装Tomcat">3.1 安装Tomcat</a></li><li><a href=#32-tomcat%e5%90%af%e5%8a%a8 aria-label="3.2 Tomcat启动">3.2 Tomcat启动</a></li><li><a href=#33-tomcat%e9%85%8d%e7%bd%ae aria-label="3.3 Tomcat配置">3.3 Tomcat配置</a></li><li><a href=#34-%e5%8f%91%e5%b8%83web%e7%bd%91%e7%ab%99 aria-label="3.4 发布web网站">3.4 发布web网站</a></li></ul></li><li><a href=#4-http aria-label="4 HTTP">4 HTTP</a><ul><li><a href=#41-%e4%bb%80%e4%b9%88%e6%98%afhttp aria-label="4.1 什么是HTTP">4.1 什么是HTTP</a></li><li><a href=#42-%e4%b8%a4%e4%b8%aa%e7%89%88%e6%9c%ac aria-label="4.2 两个版本">4.2 两个版本</a></li><li><a href=#43-http%e8%af%b7%e6%b1%82 aria-label="4.3 HTTP请求">4.3 HTTP请求</a><ul><li><a href=#%e8%af%b7%e6%b1%82%e8%a1%8c aria-label=请求行>请求行</a></li><li><a href=#%e6%b6%88%e6%81%af%e5%a4%b4 aria-label=消息头>消息头</a></li></ul></li><li><a href=#44-http%e5%93%8d%e5%ba%94 aria-label="4.4 HTTP响应">4.4 HTTP响应</a><ul><li><a href=#%e5%93%8d%e5%ba%94%e4%bd%93 aria-label=响应体>响应体</a></li><li><a href=#%e5%93%8d%e5%ba%94%e7%8a%b6%e6%80%81%e7%a0%81 aria-label=响应状态码>响应状态码</a></li></ul></li></ul></li><li><a href=#5-maven aria-label="5 Maven">5 Maven</a><ul><li><a href=#51-%e9%a1%b9%e7%9b%ae%e6%9e%b6%e6%9e%84%e7%ae%a1%e7%90%86%e5%b7%a5%e5%85%b7 aria-label="5.1 项目架构管理工具">5.1 项目架构管理工具</a></li><li><a href=#52-%e4%b8%8b%e8%bd%bd%e5%ae%89%e8%a3%85maven aria-label="5.2 下载安装Maven">5.2 下载安装Maven</a></li><li><a href=#53-%e9%85%8d%e7%bd%ae%e7%8e%af%e5%a2%83%e5%8f%98%e9%87%8f aria-label="5.3 配置环境变量">5.3 配置环境变量</a></li><li><a href=#54-%e9%85%8d%e7%bd%ae%e9%98%bf%e9%87%8c%e4%ba%91%e9%95%9c%e5%83%8f aria-label="5.4 配置阿里云镜像">5.4 配置阿里云镜像</a></li></ul></li><li><a href=#6-servlet aria-label="6 Servlet">6 Servlet</a><ul><li><a href=#61-servlet%e7%ae%80%e4%bb%8b aria-label="6.1 Servlet简介">6.1 Servlet简介</a></li><li><a href=#62-helloservlet aria-label="6.2 HelloServlet">6.2 HelloServlet</a></li><li><a href=#63-servlet%e5%8e%9f%e7%90%86 aria-label="6.3 Servlet原理">6.3 Servlet原理</a></li><li><a href=#64-mapping%e9%97%ae%e9%a2%98 aria-label="6.4 Mapping问题">6.4 Mapping问题</a></li><li><a href=#65-servletcontext aria-label="6.5 ServletContext">6.5 ServletContext</a><ul><li><a href=#1-%e5%85%b1%e4%ba%ab%e6%95%b0%e6%8d%ae aria-label="1. 共享数据">1. 共享数据</a></li><li><a href=#2-%e8%8e%b7%e5%8f%96%e5%88%9d%e5%a7%8b%e5%8c%96%e5%8f%82%e6%95%b0 aria-label="2. 获取初始化参数">2. 获取初始化参数</a></li><li><a href=#3-%e8%af%b7%e6%b1%82%e8%bd%ac%e5%8f%91 aria-label="3. 请求转发">3. 请求转发</a></li><li><a href=#4-%e8%af%bb%e5%8f%96%e8%b5%84%e6%ba%90%e6%96%87%e4%bb%b6 aria-label="4. 读取资源文件">4. 读取资源文件</a></li></ul></li><li><a href=#66-httpservletresponse aria-label="6.6 HttpServletResponse">6.6 HttpServletResponse</a><ul><li><a href=#1-%e7%ae%80%e5%8d%95%e5%88%86%e7%b1%bb aria-label="1. 简单分类">1. 简单分类</a></li><li><a href=#2-%e4%b8%8b%e8%bd%bd%e6%96%87%e4%bb%b6 aria-label="2. 下载文件">2. 下载文件</a></li><li><a href=#3-%e9%aa%8c%e8%af%81%e7%a0%81%e5%8a%9f%e8%83%bd aria-label="3. 验证码功能">3. 验证码功能</a></li><li><a href=#4-%e5%ae%9e%e7%8e%b0%e9%87%8d%e5%ae%9a%e5%90%91 aria-label="4. 实现重定向">4. 实现重定向</a></li></ul></li><li><a href=#67-httpservletrequest aria-label="6.7 HttpServletRequest">6.7 HttpServletRequest</a><ul><li><a href=#1-%e8%8e%b7%e5%8f%96%e5%8f%82%e6%95%b0 aria-label="1. 获取参数">1. 获取参数</a></li><li><a href=#2-%e8%af%b7%e6%b1%82%e8%bd%ac%e5%8f%91 aria-label="2. 请求转发">2. 请求转发</a><ul><li><a href=#%e9%87%8d%e5%ae%9a%e5%90%91%e5%92%8c%e5%92%8c%e8%af%b7%e6%b1%82%e8%bd%ac%e5%8f%91%e7%9a%84%e5%8c%ba%e5%88%ab aria-label=重定向和和请求转发的区别>重定向和和请求转发的区别</a></li></ul></li></ul></li></ul></li><li><a href=#7-cookiesession aria-label="7 Cookie、Session">7 Cookie、Session</a><ul><li><a href=#71-%e4%bc%9a%e8%af%9d aria-label="7.1 会话">7.1 会话</a></li><li><a href=#72-%e4%bf%9d%e5%ad%98%e4%bc%9a%e8%af%9d%e7%9a%84%e4%b8%a4%e7%a7%8d%e6%8a%80%e6%9c%af aria-label="7.2 保存会话的两种技术">7.2 保存会话的两种技术</a></li><li><a href=#73-cookie aria-label="7.3 Cookie">7.3 Cookie</a></li><li><a href=#74-session%e9%87%8d%e8%a6%81 aria-label="7.4 Session（重要）">7.4 Session（重要）</a><ul><li><a href=#%e4%bd%bf%e7%94%a8session aria-label=使用Session>使用Session</a></li><li><a href=#%e5%be%97%e5%88%b0session aria-label=得到Session>得到Session</a></li><li><a href=#%e6%b3%a8%e9%94%80session aria-label=注销Session>注销Session</a></li></ul></li></ul></li><li><a href=#8-jsp%e4%b8%8d%e9%87%8d%e8%a6%81 aria-label="8 JSP（不重要）">8 JSP（不重要）</a><ul><li><a href=#81-%e4%bb%80%e4%b9%88%e6%98%afjsp aria-label="8.1 什么是JSP">8.1 什么是JSP</a></li><li><a href=#82-jsp%e5%8e%9f%e7%90%86 aria-label="8.2 JSP原理">8.2 JSP原理</a></li><li><a href=#%e7%95%a5 aria-label=略>略</a></li></ul></li><li><a href=#9-javabean aria-label="9 JavaBean">9 JavaBean</a></li><li><a href=#10-mvc%e4%b8%89%e5%b1%82%e6%9e%b6%e6%9e%84 aria-label="10 MVC三层架构">10 MVC三层架构</a><ul><li><a href=#101-%e4%bb%a5%e5%89%8d%e7%9a%84%e6%9e%b6%e6%9e%84 aria-label="10.1 以前的架构">10.1 以前的架构</a></li><li><a href=#102-mvc%e4%b8%89%e5%b1%82%e6%9e%b6%e6%9e%84 aria-label="10.2 MVC三层架构">10.2 MVC三层架构</a></li></ul></li><li><a href=#11-filter%e9%87%8d%e8%a6%81 aria-label="11 Filter（重要）">11 Filter（重要）</a></li><li><a href=#12-%e7%9b%91%e5%90%ac%e5%99%a8 aria-label="12 监听器">12 监听器</a></li><li><a href=#13-%e8%bf%87%e6%bb%a4%e5%99%a8%e7%9b%91%e5%90%ac%e5%99%a8%e5%b8%b8%e8%a7%81%e5%ba%94%e7%94%a8 aria-label="13 过滤器、监听器常见应用">13 过滤器、监听器常见应用</a><ul><li><a href=#131-%e7%9b%91%e5%90%ac%e5%99%a8 aria-label="13.1 监听器">13.1 监听器</a></li><li><a href=#132-%e8%bf%87%e6%bb%a4%e5%99%a8 aria-label="13.2 过滤器">13.2 过滤器</a></li></ul></li><li><a href=#14-jdbc aria-label="14 JDBC">14 JDBC</a><ul><li><a href=#141-jdbc%e5%9b%ba%e5%ae%9a%e6%ad%a5%e9%aa%a4 aria-label="14.1 JDBC固定步骤">14.1 JDBC固定步骤</a></li><li><a href=#142-%e4%ba%8b%e5%8a%a1 aria-label="14.2 事务">14.2 事务</a></li></ul></li></ul></div></details></div></aside><script>let activeElement,elements;window.addEventListener("DOMContentLoaded",function(){checkTocPosition(),elements=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]"),activeElement=elements[0];const t=encodeURI(activeElement.getAttribute("id")).toLowerCase();document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active")},!1),window.addEventListener("resize",function(){checkTocPosition()},!1),window.addEventListener("scroll",()=>{activeElement=Array.from(elements).find(e=>{if(getOffsetTop(e)-window.pageYOffset>0&&getOffsetTop(e)-window.pageYOffset<window.innerHeight/2)return e})||activeElement,elements.forEach(e=>{const t=encodeURI(e.getAttribute("id")).toLowerCase();e===activeElement?document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active"):document.querySelector(`.inner ul li a[href="#${t}"]`).classList.remove("active")})},!1);const main=parseInt(getComputedStyle(document.body).getPropertyValue("--article-width"),10),toc=parseInt(getComputedStyle(document.body).getPropertyValue("--toc-width"),10),gap=parseInt(getComputedStyle(document.body).getPropertyValue("--gap"),10);function checkTocPosition(){const e=document.body.scrollWidth;e-main-toc*2-gap*4>0?document.getElementById("toc-container").classList.add("wide"):document.getElementById("toc-container").classList.remove("wide")}function getOffsetTop(e){if(!e.getClientRects().length)return 0;let t=e.getBoundingClientRect(),n=e.ownerDocument.defaultView;return t.top+n.pageYOffset}</script><div class=post-content><p>最近在重温JavaWeb的内容，特此记录一下。</p><h2 id=1-基本概念>1 基本概念<a hidden class=anchor aria-hidden=true href=#1-基本概念>#</a></h2><h3 id=11-前言>1.1 前言<a hidden class=anchor aria-hidden=true href=#11-前言>#</a></h3><p>web开发：</p><ul><li>静态web<ul><li>html，css</li><li>提供给所有人看的数据始终不会变化</li></ul></li><li>动态web<ul><li>几乎所有网站，淘宝</li><li>提供给所有人看的数据始终会发生变化，每个人在不同的时间、不同的地点看到的信息各不相同</li><li>servlet/jsp，asp，php</li></ul></li></ul><h3 id=12-web应用程序>1.2 web应用程序<a hidden class=anchor aria-hidden=true href=#12-web应用程序>#</a></h3><p>可以提供浏览器访问的程序</p><ul><li>a.html、b.html等多个web资源，这些web资源可以被外界访问，对外界提供服务</li><li>能访问到的任何一个页面或者资源，都存在于世界某个地方的计算机上</li><li>url</li><li>统一的web资源会被放在同一个文件夹下，web应用程序—>Tomcat服务器</li><li>一个web应用有多个部分组成（静态web、动态web）<ul><li>html，css，js</li><li>jsp，servlet</li><li>Java程序</li><li>jar包</li><li>配置文件（properties，xml）</li></ul></li><li>web应用程序编写完后，若想要提供给外部访问，需要一个服务器来统一管理</li></ul><h3 id=13-静态web>1.3 静态web<a hidden class=anchor aria-hidden=true href=#13-静态web>#</a></h3><ul><li><p>*.html，*.html这些都是网站的资源，如果服务器上一直存在这些资源，我们就可以直接进行读取，需要网络</p><p><img loading=lazy src=%e9%9d%99%e6%80%81web.png alt></p></li><li><p>静态web的缺点</p><ul><li>web页面无法动态更新，所有用户看到的都是一个页面<ul><li>轮播图，点击特效：伪动态</li><li>JavaScript</li></ul></li><li>无法和数据库交互（数据无法持久化，用户无法交互）</li></ul></li></ul><h3 id=14-动态web>1.4 动态web<a hidden class=anchor aria-hidden=true href=#14-动态web>#</a></h3><ul><li>页面会动态展示，web页面的展示效果因人而异</li></ul><p><img loading=lazy src=%e5%8a%a8%e6%80%81web.png alt></p><ul><li><p>动态web的缺点</p><ul><li>如果服务器的动态web资源出现了错误，需要重新编写后台程序，重新发布</li><li>停机维护</li></ul></li><li><p>动态web的优点</p><ul><li><p>web页面可以动态更新，所有用户看到的不是同一个页面</p></li><li><p>可以与数据库交互</p><p><img loading=lazy src=%e5%8a%a8%e6%80%81web2.png alt></p></li></ul></li></ul><h2 id=2-web服务器>2 Web服务器<a hidden class=anchor aria-hidden=true href=#2-web服务器>#</a></h2><h3 id=21-技术讲解>2.1 技术讲解<a hidden class=anchor aria-hidden=true href=#21-技术讲解>#</a></h3><h4 id=asp>ASP<a hidden class=anchor aria-hidden=true href=#asp>#</a></h4><ul><li>微软：国内最早流行的就是ASP</li><li>在html中嵌入了VB的脚本，ASP+COM</li><li>在ASP开发中，基本一个页面有几千行的业务代码，页面混乱</li><li>维护成本高</li><li>C#</li><li>IIS</li></ul><h4 id=php>PHP<a hidden class=anchor aria-hidden=true href=#php>#</a></h4><ul><li>php开发速度很快，功能强大，跨平台，代码简单</li><li>无法承载大访问量的情况</li></ul><h4 id=servletjsp>servlet/jsp<a hidden class=anchor aria-hidden=true href=#servletjsp>#</a></h4><ul><li>sun公司主推的B/S架构</li><li>基于Java语言</li><li>可以承载三高问题带来的影响</li><li>语法像ASP</li></ul><h3 id=22-web服务器>2.2 web服务器<a hidden class=anchor aria-hidden=true href=#22-web服务器>#</a></h3><p>服务器是一种被动的操作，用来处理用户的一些请求和给用户一些响应信息</p><ul><li>IIS，微软的</li><li>Tomcat</li></ul><h2 id=3-tomcat>3 Tomcat<a hidden class=anchor aria-hidden=true href=#3-tomcat>#</a></h2><h3 id=31-安装tomcat>3.1 安装Tomcat<a hidden class=anchor aria-hidden=true href=#31-安装tomcat>#</a></h3><h3 id=32-tomcat启动>3.2 Tomcat启动<a hidden class=anchor aria-hidden=true href=#32-tomcat启动>#</a></h3><h3 id=33-tomcat配置>3.3 Tomcat配置<a hidden class=anchor aria-hidden=true href=#33-tomcat配置>#</a></h3><p>网站是如何进行访问的</p><ol><li>输入一个域名，回车</li><li>检查本机的hosts配置文件内是否存在域名映射<ol><li>有：直接访问对应的ip地址，找到需要访问的web程序，可以直接访问</li><li>没有：去DNS服务器找对应的ip地址，找到则返回</li></ol></li></ol><h3 id=34-发布web网站>3.4 发布web网站<a hidden class=anchor aria-hidden=true href=#34-发布web网站>#</a></h3><ul><li><p>将自己写的网站，放到服务器（Tomcat）指定的web应用的文件夹（webapps）下，就可以访问了</p></li><li><p>网站应有的架构</p></li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl>--webapps ：Tomcat服务器的web目录
</span></span><span class=line><span class=cl>	-ROOT
</span></span><span class=line><span class=cl>	-testweb ：网站的目录名
</span></span><span class=line><span class=cl>		- WEB-INF
</span></span><span class=line><span class=cl>			-classes : java程序
</span></span><span class=line><span class=cl>			-lib：web应用所依赖的jar包
</span></span><span class=line><span class=cl>			-web.xml ：网站配置文件
</span></span><span class=line><span class=cl>		- index.html 默认的首页
</span></span><span class=line><span class=cl>		- static 
</span></span><span class=line><span class=cl>            -css
</span></span><span class=line><span class=cl>            	-style.css
</span></span><span class=line><span class=cl>            -js
</span></span><span class=line><span class=cl>            -img
</span></span><span class=line><span class=cl>         -.....
</span></span></code></pre></td></tr></table></div></div><h2 id=4-http>4 HTTP<a hidden class=anchor aria-hidden=true href=#4-http>#</a></h2><h3 id=41-什么是http>4.1 什么是HTTP<a hidden class=anchor aria-hidden=true href=#41-什么是http>#</a></h3><p>超文本传输协议是一个简单的请求-响应协议，通常运行在TCP之上</p><ul><li>文本：html，字符串，……</li><li>超文本：图片，音乐，视频，定位，地图，……</li><li>端口：80</li></ul><p>HTTPS：安全的</p><h3 id=42-两个版本>4.2 两个版本<a hidden class=anchor aria-hidden=true href=#42-两个版本>#</a></h3><ul><li>http 1.0<ul><li>HTTP/1.0：客户端与web服务器连接后，只能获得一个web资源</li></ul></li><li>http 2.0<ul><li>HTTP/2.0：客户端与web服务器连接后，可以获得多个web资源</li></ul></li></ul><h3 id=43-http请求>4.3 HTTP请求<a hidden class=anchor aria-hidden=true href=#43-http请求>#</a></h3><ul><li>客户端—request—服务器</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl>Request URL:https://www.baidu.com/   请求地址
</span></span><span class=line><span class=cl>Request Method:GET    get方法/post方法
</span></span><span class=line><span class=cl>Status Code:200 OK    状态码：200
</span></span><span class=line><span class=cl>Remote（远程） Address:14.215.177.39:443
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Accept:text/html  
</span></span><span class=line><span class=cl>Accept-Encoding:gzip, deflate, br
</span></span><span class=line><span class=cl>Accept-Language:zh-CN,zh;q=0.9    语言
</span></span><span class=line><span class=cl>Cache-Control:max-age=0
</span></span><span class=line><span class=cl>Connection:keep-alive
</span></span></code></pre></td></tr></table></div></div><h4 id=请求行>请求行<a hidden class=anchor aria-hidden=true href=#请求行>#</a></h4><ul><li>请求行中的请求方式：GET</li><li>请求方式：GET，POST，HEAD，DELETE，PUT，TRACT，……<ul><li>GET：请求能够携带的参数比较少，大小有限制，会在浏览器的URL地址栏显示数据内容，不安全，但高效</li><li>POST：请求能够携带的参数没有限制，大小没有限制，不会在浏览器的URL地址栏显示数据内容，安全，但不高效</li></ul></li></ul><h4 id=消息头>消息头<a hidden class=anchor aria-hidden=true href=#消息头>#</a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl>Accept:告诉浏览器支持的数据类型
</span></span><span class=line><span class=cl>Accept-Encoding:支持哪种编码格式 GBK	UTF-8	GB2312	ISO8859-1
</span></span><span class=line><span class=cl>Accept-Language:告诉浏览器语言环境
</span></span><span class=line><span class=cl>Cache-Control:缓存控制
</span></span><span class=line><span class=cl>Connection:告诉浏览器请求完成是断开还是保持连接
</span></span><span class=line><span class=cl>HOST：主机
</span></span></code></pre></td></tr></table></div></div><h3 id=44-http响应>4.4 HTTP响应<a hidden class=anchor aria-hidden=true href=#44-http响应>#</a></h3><ul><li>服务器—response—客户端</li></ul><h4 id=响应体>响应体<a hidden class=anchor aria-hidden=true href=#响应体>#</a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl>Accept：告诉浏览器支持的数据类型
</span></span><span class=line><span class=cl>Accept-Encoding：支持哪种编码格式  GBK   UTF-8   GB2312  ISO8859-1
</span></span><span class=line><span class=cl>Accept-Language：告诉浏览器语言环境
</span></span><span class=line><span class=cl>Cache-Control：缓存控制
</span></span><span class=line><span class=cl>Connection：告诉浏览器请求完成是断开还是保持连接
</span></span><span class=line><span class=cl>HOST：主机
</span></span><span class=line><span class=cl>Refresh：告诉客户端，多久刷新一次
</span></span><span class=line><span class=cl>Location：让网页重新定位
</span></span></code></pre></td></tr></table></div></div><h4 id=响应状态码>响应状态码<a hidden class=anchor aria-hidden=true href=#响应状态码>#</a></h4><ul><li>200：请求响应成功</li><li>3xx：请求重定向</li><li>4xx：找不到资源404</li><li>5xx：服务器代码错误500，502：网关错误</li></ul><h2 id=5-maven>5 Maven<a hidden class=anchor aria-hidden=true href=#5-maven>#</a></h2><p>在JavaWeb开发中，需要使用大量的jar包，手动导入很繁琐，如何自动导入和配置jar包</p><h3 id=51-项目架构管理工具>5.1 项目架构管理工具<a hidden class=anchor aria-hidden=true href=#51-项目架构管理工具>#</a></h3><p>Maven的核心思想：约定大于配置。Maven会规定如何编写Java代码</p><h3 id=52-下载安装maven>5.2 下载安装Maven<a hidden class=anchor aria-hidden=true href=#52-下载安装maven>#</a></h3><h3 id=53-配置环境变量>5.3 配置环境变量<a hidden class=anchor aria-hidden=true href=#53-配置环境变量>#</a></h3><h3 id=54-配置阿里云镜像>5.4 配置阿里云镜像<a hidden class=anchor aria-hidden=true href=#54-配置阿里云镜像>#</a></h3><h2 id=6-servlet>6 Servlet<a hidden class=anchor aria-hidden=true href=#6-servlet>#</a></h2><h3 id=61-servlet简介>6.1 Servlet简介<a hidden class=anchor aria-hidden=true href=#61-servlet简介>#</a></h3><ul><li>Servlet是sun公司开发动态web的一门技术</li><li>sun在这些api中提供一个接口叫做Servlet，如果想开发一个Servlet程序，只需要<ul><li>编写一个类，实现Servlet接口</li><li>把开发好的Java类部署到服务器中</li></ul></li><li>把实现了Servlet接口的Java程序叫做Servlet</li></ul><h3 id=62-helloservlet>6.2 HelloServlet<a hidden class=anchor aria-hidden=true href=#62-helloservlet>#</a></h3><ol><li><p>构建一个普通的Maven项目</p></li><li><p>编写一个Serlvet程序</p><ol><li>编写一个普通类</li><li>实现Servlet接口，这里直接继承HttpServlet</li></ol></li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>HelloServlet</span> <span class=kd>extends</span> <span class=n>HttpServlet</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>//由于get或者post只是请求实现的不同的方式，可以相互调用，业务逻辑都一样；
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>protected</span> <span class=kt>void</span> <span class=nf>doGet</span><span class=o>(</span><span class=n>HttpServletRequest</span> <span class=n>req</span><span class=o>,</span> <span class=n>HttpServletResponse</span> <span class=n>resp</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=kd>throws</span> <span class=n>ServletException</span><span class=o>,</span> <span class=n>IOException</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>//ServletOutputStream outputStream = resp.getOutputStream();
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>PrintWriter</span> <span class=n>writer</span> <span class=o>=</span> <span class=n>resp</span><span class=o>.</span><span class=na>getWriter</span><span class=o>();</span> <span class=c1>//响应流
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>writer</span><span class=o>.</span><span class=na>print</span><span class=o>(</span><span class=s>&#34;Hello,Serlvet&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>protected</span> <span class=kt>void</span> <span class=nf>doPost</span><span class=o>(</span><span class=n>HttpServletRequest</span> <span class=n>req</span><span class=o>,</span> <span class=n>HttpServletResponse</span> <span class=n>resp</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=kd>throws</span> <span class=n>ServletException</span><span class=o>,</span> <span class=n>IOException</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>doGet</span><span class=o>(</span><span class=n>req</span><span class=o>,</span> <span class=n>resp</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><ol start=3><li><p>编写Servlet的映射</p><p>为什么需要映射，我们写的是Java程序，但是要通过浏览器访问，而浏览器需要连接web服务器，所以我们需要在web服务中注册我们写的Servlet，还需要定义一个浏览器能够访问的路径</p></li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=c>&lt;!--注册Servlet--&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;servlet&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;servlet-name&gt;</span>hello<span class=nt>&lt;/servlet-name&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;servlet-class&gt;</span>com.hjc.servlet.HelloServlet<span class=nt>&lt;/servlet-class&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/servlet&gt;</span>
</span></span><span class=line><span class=cl><span class=c>&lt;!--Servlet的请求路径--&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;servlet-mapping&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;servlet-name&gt;</span>hello<span class=nt>&lt;/servlet-name&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;url-pattern&gt;</span>/hello<span class=nt>&lt;/url-pattern&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/servlet-mapping&gt;</span>
</span></span></code></pre></td></tr></table></div></div><ol start=4><li><p>配置Tomcat</p></li><li><p>启动测试</p></li></ol><h3 id=63-servlet原理>6.3 Servlet原理<a hidden class=anchor aria-hidden=true href=#63-servlet原理>#</a></h3><p>Servlet是由web服务器在收到浏览器请求后调用</p><p><img loading=lazy src=Servlet.png alt></p><h3 id=64-mapping问题>6.4 Mapping问题<a hidden class=anchor aria-hidden=true href=#64-mapping问题>#</a></h3><ol><li>一个servlet可以指定一个映射路径</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;servlet-mapping&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;servlet-name&gt;</span>hello<span class=nt>&lt;/servlet-name&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;url-pattern&gt;</span>/hello<span class=nt>&lt;/url-pattern&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/servlet-mapping&gt;</span>
</span></span></code></pre></td></tr></table></div></div><ol start=2><li>一个servlet可以指定多个映射路径</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;servlet-mapping&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;servlet-name&gt;</span>hello<span class=nt>&lt;/servlet-name&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;url-pattern&gt;</span>/hello<span class=nt>&lt;/url-pattern&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/servlet-mapping&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;servlet-mapping&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;servlet-name&gt;</span>hello<span class=nt>&lt;/servlet-name&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;url-pattern&gt;</span>/hello2<span class=nt>&lt;/url-pattern&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/servlet-mapping&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;servlet-mapping&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;servlet-name&gt;</span>hello<span class=nt>&lt;/servlet-name&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;url-pattern&gt;</span>/hello3<span class=nt>&lt;/url-pattern&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/servlet-mapping&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;servlet-mapping&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;servlet-name&gt;</span>hello<span class=nt>&lt;/servlet-name&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;url-pattern&gt;</span>/hello4<span class=nt>&lt;/url-pattern&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/servlet-mapping&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;servlet-mapping&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;servlet-name&gt;</span>hello<span class=nt>&lt;/servlet-name&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;url-pattern&gt;</span>/hello5<span class=nt>&lt;/url-pattern&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/servlet-mapping&gt;</span>
</span></span></code></pre></td></tr></table></div></div><ol start=3><li>一个servlet可以指定通用映射路径</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;servlet-mapping&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;servlet-name&gt;</span>hello<span class=nt>&lt;/servlet-name&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;url-pattern&gt;</span>/hello/*<span class=nt>&lt;/url-pattern&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/servlet-mapping&gt;</span>
</span></span></code></pre></td></tr></table></div></div><ol start=4><li>默认请求路径</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=c>&lt;!--默认请求路径--&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;servlet-mapping&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;servlet-name&gt;</span>hello<span class=nt>&lt;/servlet-name&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;url-pattern&gt;</span>/*<span class=nt>&lt;/url-pattern&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/servlet-mapping&gt;</span>
</span></span></code></pre></td></tr></table></div></div><ol start=5><li>指定一些后缀或者前缀</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=c>&lt;!--可以自定义后缀实现请求映射
</span></span></span><span class=line><span class=cl><span class=c>    注意点，*前面不能加项目映射的路径
</span></span></span><span class=line><span class=cl><span class=c>    hello/sajdlkajda.do
</span></span></span><span class=line><span class=cl><span class=c>    --&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;servlet-mapping&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;servlet-name&gt;</span>hello<span class=nt>&lt;/servlet-name&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;url-pattern&gt;</span>*.do<span class=nt>&lt;/url-pattern&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/servlet-mapping&gt;</span>
</span></span></code></pre></td></tr></table></div></div><ol start=6><li>优先级问题</li></ol><p>指定了固有的映射路径优先级最高，如果找不到就会走默认的处理请求</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=c>&lt;!--404--&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;servlet&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;servlet-name&gt;</span>error<span class=nt>&lt;/servlet-name&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;servlet-class&gt;</span>com.hjc.servlet.ErrorServlet<span class=nt>&lt;/servlet-class&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/servlet&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;servlet-mapping&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;servlet-name&gt;</span>error<span class=nt>&lt;/servlet-name&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;url-pattern&gt;</span>/*<span class=nt>&lt;/url-pattern&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/servlet-mapping&gt;</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=65-servletcontext>6.5 ServletContext<a hidden class=anchor aria-hidden=true href=#65-servletcontext>#</a></h3><p>web容器在启动的时候，它会为每个web程序都创建一个对应的ServletContext对象，代表当前的web应用</p><h4 id=1-共享数据>1. 共享数据<a hidden class=anchor aria-hidden=true href=#1-共享数据>#</a></h4><p>在一个servlet中保存的数据，可以在另一个servlet中得到</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>HelloServlet</span> <span class=kd>extends</span> <span class=n>HttpServlet</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>protected</span> <span class=kt>void</span> <span class=nf>doGet</span><span class=o>(</span><span class=n>HttpServletRequest</span> <span class=n>req</span><span class=o>,</span> <span class=n>HttpServletResponse</span> <span class=n>resp</span><span class=o>)</span>
</span></span><span class=line><span class=cl>        <span class=kd>throws</span> <span class=n>ServletException</span><span class=o>,</span> <span class=n>IOException</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>//this.getInitParameter()   初始化参数
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=c1>//this.getServletConfig()   Servlet配置
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=c1>//this.getServletContext()  Servlet上下文
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>ServletContext</span> <span class=n>context</span> <span class=o>=</span> <span class=k>this</span><span class=o>.</span><span class=na>getServletContext</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=n>String</span> <span class=n>username</span> <span class=o>=</span> <span class=s>&#34;hjc&#34;</span><span class=o>;</span> <span class=c1>//数据
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>context</span><span class=o>.</span><span class=na>setAttribute</span><span class=o>(</span><span class=s>&#34;username&#34;</span><span class=o>,</span><span class=n>username</span><span class=o>);</span> 
</span></span><span class=line><span class=cl>        <span class=c1>//将一个数据保存在了ServletContext中，名字为username，值为username
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>GetServlet</span> <span class=kd>extends</span> <span class=n>HttpServlet</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>protected</span> <span class=kt>void</span> <span class=nf>doGet</span><span class=o>(</span><span class=n>HttpServletRequest</span> <span class=n>req</span><span class=o>,</span> <span class=n>HttpServletResponse</span> <span class=n>resp</span><span class=o>)</span>
</span></span><span class=line><span class=cl>        <span class=kd>throws</span> <span class=n>ServletException</span><span class=o>,</span> <span class=n>IOException</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>ServletContext</span> <span class=n>context</span> <span class=o>=</span> <span class=k>this</span><span class=o>.</span><span class=na>getServletContext</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=n>String</span> <span class=n>username</span> <span class=o>=</span> <span class=o>(</span><span class=n>String</span><span class=o>)</span> <span class=n>context</span><span class=o>.</span><span class=na>getAttribute</span><span class=o>(</span><span class=s>&#34;username&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>resp</span><span class=o>.</span><span class=na>setContentType</span><span class=o>(</span><span class=s>&#34;text/html&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>resp</span><span class=o>.</span><span class=na>setCharacterEncoding</span><span class=o>(</span><span class=s>&#34;utf-8&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>resp</span><span class=o>.</span><span class=na>getWriter</span><span class=o>().</span><span class=na>print</span><span class=o>(</span><span class=s>&#34;名字&#34;</span><span class=o>+</span><span class=n>username</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;servlet&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;servlet-name&gt;</span>hello<span class=nt>&lt;/servlet-name&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;servlet-class&gt;</span>com.hjc.servlet.HelloServlet<span class=nt>&lt;/servlet-class&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/servlet&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;servlet-mapping&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;servlet-name&gt;</span>hello<span class=nt>&lt;/servlet-name&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;url-pattern&gt;</span>/hello<span class=nt>&lt;/url-pattern&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/servlet-mapping&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nt>&lt;servlet&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;servlet-name&gt;</span>get<span class=nt>&lt;/servlet-name&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;servlet-class&gt;</span>com.hjc.servlet.GetServlet<span class=nt>&lt;/servlet-class&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/servlet&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;servlet-mapping&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;servlet-name&gt;</span>get<span class=nt>&lt;/servlet-name&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;url-pattern&gt;</span>/get<span class=nt>&lt;/url-pattern&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/servlet-mapping&gt;</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=2-获取初始化参数>2. 获取初始化参数<a hidden class=anchor aria-hidden=true href=#2-获取初始化参数>#</a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=c>&lt;!--配置一些web应用初始化参数--&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;context-param&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;param-name&gt;</span>url<span class=nt>&lt;/param-name&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;param-value&gt;</span>jdbc:mysql://localhost:3306/mybatis<span class=nt>&lt;/param-value&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/context-param&gt;</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>HelloServlet</span> <span class=kd>extends</span> <span class=n>HttpServlet</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>protected</span> <span class=kt>void</span> <span class=nf>doGet</span><span class=o>(</span><span class=n>HttpServletRequest</span> <span class=n>req</span><span class=o>,</span> <span class=n>HttpServletResponse</span> <span class=n>resp</span><span class=o>)</span>
</span></span><span class=line><span class=cl>        <span class=kd>throws</span> <span class=n>ServletException</span><span class=o>,</span> <span class=n>IOException</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>ServletContext</span> <span class=n>context</span> <span class=o>=</span> <span class=k>this</span><span class=o>.</span><span class=na>getServletContext</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=n>String</span> <span class=n>url</span> <span class=o>=</span> <span class=n>context</span><span class=o>.</span><span class=na>getInitParameter</span><span class=o>(</span><span class=s>&#34;url&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>resp</span><span class=o>.</span><span class=na>getWriter</span><span class=o>().</span><span class=na>print</span><span class=o>(</span><span class=n>url</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=3-请求转发>3. 请求转发<a hidden class=anchor aria-hidden=true href=#3-请求转发>#</a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>HelloServlet</span> <span class=kd>extends</span> <span class=n>HttpServlet</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>protected</span> <span class=kt>void</span> <span class=nf>doGet</span><span class=o>(</span><span class=n>HttpServletRequest</span> <span class=n>req</span><span class=o>,</span> <span class=n>HttpServletResponse</span> <span class=n>resp</span><span class=o>)</span>
</span></span><span class=line><span class=cl>        <span class=kd>throws</span> <span class=n>ServletException</span><span class=o>,</span> <span class=n>IOException</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>ServletContext</span> <span class=n>context</span> <span class=o>=</span> <span class=k>this</span><span class=o>.</span><span class=na>getServletContext</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=n>context</span><span class=o>.</span><span class=na>getRequestDispatcher</span><span class=o>(</span><span class=s>&#34;/gp&#34;</span><span class=o>).</span><span class=na>forward</span><span class=o>(</span><span class=n>req</span><span class=o>,</span> <span class=n>resp</span><span class=o>);</span>	<span class=c1>// gp为转发路径
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=4-读取资源文件>4. 读取资源文件<a hidden class=anchor aria-hidden=true href=#4-读取资源文件>#</a></h4><p>Properties</p><ul><li>在java目录下新建properties</li><li>在resources目录下新建properties</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-properties data-lang=properties><span class=line><span class=cl><span class=na>username</span><span class=o>=</span><span class=s>root</span>
</span></span><span class=line><span class=cl><span class=na>password</span><span class=o>=</span><span class=s>123456</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>ServletDemo</span> <span class=kd>extends</span> <span class=n>HttpServlet</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>protected</span> <span class=kt>void</span> <span class=nf>doGet</span><span class=o>(</span><span class=n>HttpServletRequest</span> <span class=n>req</span><span class=o>,</span> <span class=n>HttpServletResponse</span> <span class=n>resp</span><span class=o>)</span>
</span></span><span class=line><span class=cl>        <span class=kd>throws</span> <span class=n>ServletException</span><span class=o>,</span> <span class=n>IOException</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>InputStream</span> <span class=n>is</span> <span class=o>=</span> <span class=k>this</span><span class=o>.</span><span class=na>getServletContext</span><span class=o>()</span>
</span></span><span class=line><span class=cl>            <span class=o>.</span><span class=na>getResourceAsStream</span><span class=o>(</span><span class=s>&#34;/WEB-INF/classes/com/hjc/servlet/test.properties&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>Properties</span> <span class=n>prop</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Properties</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=n>prop</span><span class=o>.</span><span class=na>load</span><span class=o>(</span><span class=n>is</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>String</span> <span class=n>user</span> <span class=o>=</span> <span class=n>prop</span><span class=o>.</span><span class=na>getProperty</span><span class=o>(</span><span class=s>&#34;username&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>String</span> <span class=n>pwd</span> <span class=o>=</span> <span class=n>prop</span><span class=o>.</span><span class=na>getProperty</span><span class=o>(</span><span class=s>&#34;password&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>resp</span><span class=o>.</span><span class=na>getWriter</span><span class=o>().</span><span class=na>print</span><span class=o>(</span><span class=n>user</span><span class=o>+</span><span class=s>&#34;:&#34;</span><span class=o>+</span><span class=n>pwd</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>protected</span> <span class=kt>void</span> <span class=nf>doPost</span><span class=o>(</span><span class=n>HttpServletRequest</span> <span class=n>req</span><span class=o>,</span> <span class=n>HttpServletResponse</span> <span class=n>resp</span><span class=o>)</span>
</span></span><span class=line><span class=cl>        <span class=kd>throws</span> <span class=n>ServletException</span><span class=o>,</span> <span class=n>IOException</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>doGet</span><span class=o>(</span><span class=n>req</span><span class=o>,</span> <span class=n>resp</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=66-httpservletresponse>6.6 HttpServletResponse<a hidden class=anchor aria-hidden=true href=#66-httpservletresponse>#</a></h3><ul><li>web服务器接收到客户端的http请求，针对这个请求，分别创建一个代表请求的HttpServletRequest对象和代表相应的HttpServletResponse对象</li><li>如果要获取客户端请求过来的参数，找HttpServletRequest</li><li>如果要给客户端响应一些信息，找HttpServletResponse</li></ul><h4 id=1-简单分类>1. 简单分类<a hidden class=anchor aria-hidden=true href=#1-简单分类>#</a></h4><p>负责向浏览器发送数据的方法</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>servletOutputstream</span> <span class=nf>getOutputstream</span><span class=o>()</span> <span class=kd>throws</span> <span class=n>IOException</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=n>Printwriter</span> <span class=nf>getwriter</span><span class=o>()</span> <span class=kd>throws</span> <span class=n>IOException</span><span class=o>;</span>
</span></span></code></pre></td></tr></table></div></div><p>负责向浏览器发送响应头的方法</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kt>void</span> <span class=nf>setCharacterEncoding</span><span class=o>(</span><span class=n>String</span> <span class=n>var1</span><span class=o>)</span><span class=err>；</span>
</span></span><span class=line><span class=cl><span class=kt>void</span> <span class=nf>setContentLength</span><span class=o>(</span><span class=kt>int</span> <span class=n>var1</span><span class=o>)</span><span class=err>；</span>
</span></span><span class=line><span class=cl><span class=kt>void</span> <span class=nf>setContentLengthLong</span><span class=o>(</span><span class=kt>long</span> <span class=n>var1</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=kt>void</span> <span class=nf>setContentType</span><span class=o>(</span><span class=n>String</span> <span class=n>var1</span><span class=o>)</span><span class=err>；</span>
</span></span><span class=line><span class=cl><span class=kt>void</span> <span class=nf>setDateHeader</span><span class=o>(</span><span class=n>String</span> <span class=n>varl</span><span class=o>,</span><span class=kt>long</span> <span class=n>var2</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=kt>void</span> <span class=nf>addDateHeader</span><span class=o>(</span><span class=n>String</span> <span class=n>var1</span><span class=o>,</span><span class=kt>long</span> <span class=n>var2</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=kt>void</span> <span class=nf>setHeader</span><span class=o>(</span><span class=n>String</span> <span class=n>var1</span><span class=o>,</span><span class=n>String</span> <span class=n>var2</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=kt>void</span> <span class=nf>addHeader</span><span class=o>(</span><span class=n>String</span> <span class=n>var1</span><span class=o>,</span><span class=n>String</span> <span class=n>var2</span><span class=o>)</span><span class=err>；</span>
</span></span><span class=line><span class=cl><span class=kt>void</span> <span class=nf>setIntHeader</span><span class=o>(</span><span class=n>String</span> <span class=n>var1</span><span class=o>,</span><span class=kt>int</span> <span class=n>var2</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=kt>void</span> <span class=nf>addIntHeader</span><span class=o>(</span><span class=n>String</span> <span class=n>varl</span><span class=o>,</span><span class=kt>int</span> <span class=n>var2</span><span class=o>);</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=2-下载文件>2. 下载文件<a hidden class=anchor aria-hidden=true href=#2-下载文件>#</a></h4><ol><li>向浏览器输出消息</li><li>下载文件<ol><li>获取下载文件的路径</li><li>获取下载文件的文件名</li><li>设置让浏览器支持下载需要的东西</li><li>获取下载文件的输入流</li><li>创建缓冲区</li><li>获取OutputStream对象</li><li>将FileOutputStream流写入到buffer缓冲区</li><li>使用OutputStream将缓冲区内的数据输出到客户端</li></ol></li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Override</span>
</span></span><span class=line><span class=cl><span class=kd>protected</span> <span class=kt>void</span> <span class=nf>doGet</span><span class=o>(</span><span class=n>HttpServletRequest</span> <span class=n>req</span><span class=o>,</span> <span class=n>HttpServletResponse</span> <span class=n>resp</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=kd>throws</span> <span class=n>ServletException</span><span class=o>,</span> <span class=n>IOException</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 1. 要获取下载文件的路径
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>String</span> <span class=n>realPath</span> <span class=o>=</span> <span class=n>path</span><span class=o>;</span>	<span class=c1>//路径
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;下载文件的路径：&#34;</span><span class=o>+</span><span class=n>realPath</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 2. 下载的文件名是啥？
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>String</span> <span class=n>fileName</span> <span class=o>=</span> <span class=n>realPath</span><span class=o>.</span><span class=na>substring</span><span class=o>(</span><span class=n>realPath</span><span class=o>.</span><span class=na>lastIndexOf</span><span class=o>(</span><span class=s>&#34;\\&#34;</span><span class=o>)</span> <span class=o>+</span> <span class=n>1</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 3. 设置想办法让浏览器能够支持(Content-Disposition)下载我们需要的东西,中文文件名URLEncoder.encode编码，否则有可能乱码
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>resp</span><span class=o>.</span><span class=na>setHeader</span><span class=o>(</span><span class=s>&#34;Content-Disposition&#34;</span><span class=o>,</span><span class=s>&#34;attachment;filename=&#34;</span><span class=o>+</span><span class=n>URLEncoder</span><span class=o>.</span><span class=na>encode</span><span class=o>(</span><span class=n>fileName</span><span class=o>,</span><span class=s>&#34;UTF-8&#34;</span><span class=o>));</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 4. 获取下载文件的输入流
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>FileInputStream</span> <span class=n>in</span> <span class=o>=</span> <span class=k>new</span> <span class=n>FileInputStream</span><span class=o>(</span><span class=n>realPath</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 5. 创建缓冲区
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kt>int</span> <span class=n>len</span> <span class=o>=</span> <span class=n>0</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kt>byte</span><span class=o>[]</span> <span class=n>buffer</span> <span class=o>=</span> <span class=k>new</span> <span class=kt>byte</span><span class=o>[</span><span class=n>1024</span><span class=o>];</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 6. 获取OutputStream对象
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>ServletOutputStream</span> <span class=n>out</span> <span class=o>=</span> <span class=n>resp</span><span class=o>.</span><span class=na>getOutputStream</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 7. 将FileOutputStream流写入到buffer缓冲区,使用OutputStream将缓冲区中的数据输出到客户端！
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>while</span> <span class=o>((</span><span class=n>len</span><span class=o>=</span><span class=n>in</span><span class=o>.</span><span class=na>read</span><span class=o>(</span><span class=n>buffer</span><span class=o>))&gt;</span><span class=n>0</span><span class=o>){</span>
</span></span><span class=line><span class=cl>        <span class=n>out</span><span class=o>.</span><span class=na>write</span><span class=o>(</span><span class=n>buffer</span><span class=o>,</span><span class=n>0</span><span class=o>,</span><span class=n>len</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>in</span><span class=o>.</span><span class=na>close</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=n>out</span><span class=o>.</span><span class=na>close</span><span class=o>();</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=3-验证码功能>3. 验证码功能<a hidden class=anchor aria-hidden=true href=#3-验证码功能>#</a></h4><p>验证码实现</p><ul><li>前端实现</li><li>后端实现，需要用到Java的图片类，生产一个图片</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>ImageServlet</span> <span class=kd>extends</span> <span class=n>HttpServlet</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>protected</span> <span class=kt>void</span> <span class=nf>doGet</span><span class=o>(</span><span class=n>HttpServletRequest</span> <span class=n>req</span><span class=o>,</span> <span class=n>HttpServletResponse</span> <span class=n>resp</span><span class=o>)</span>
</span></span><span class=line><span class=cl>        <span class=kd>throws</span> <span class=n>ServletException</span><span class=o>,</span> <span class=n>IOException</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>//如何让浏览器3秒自动刷新一次;
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>resp</span><span class=o>.</span><span class=na>setHeader</span><span class=o>(</span><span class=s>&#34;refresh&#34;</span><span class=o>,</span><span class=s>&#34;3&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1>//在内存中创建一个图片
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>BufferedImage</span> <span class=n>image</span> <span class=o>=</span> <span class=k>new</span> <span class=n>BufferedImage</span><span class=o>(</span><span class=n>80</span><span class=o>,</span><span class=n>20</span><span class=o>,</span><span class=n>BufferedImage</span><span class=o>.</span><span class=na>TYPE_INT_RGB</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=c1>//得到图片
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>Graphics2D</span> <span class=n>g</span> <span class=o>=</span> <span class=o>(</span><span class=n>Graphics2D</span><span class=o>)</span> <span class=n>image</span><span class=o>.</span><span class=na>getGraphics</span><span class=o>();</span> <span class=c1>//笔
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=c1>//设置图片的背景颜色
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>g</span><span class=o>.</span><span class=na>setColor</span><span class=o>(</span><span class=n>Color</span><span class=o>.</span><span class=na>white</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>g</span><span class=o>.</span><span class=na>fillRect</span><span class=o>(</span><span class=n>0</span><span class=o>,</span><span class=n>0</span><span class=o>,</span><span class=n>80</span><span class=o>,</span><span class=n>20</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=c1>//给图片写数据
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>g</span><span class=o>.</span><span class=na>setColor</span><span class=o>(</span><span class=n>Color</span><span class=o>.</span><span class=na>BLUE</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>g</span><span class=o>.</span><span class=na>setFont</span><span class=o>(</span><span class=k>new</span> <span class=n>Font</span><span class=o>(</span><span class=kc>null</span><span class=o>,</span><span class=n>Font</span><span class=o>.</span><span class=na>BOLD</span><span class=o>,</span><span class=n>20</span><span class=o>));</span>
</span></span><span class=line><span class=cl>        <span class=n>g</span><span class=o>.</span><span class=na>drawString</span><span class=o>(</span><span class=n>makeNum</span><span class=o>(),</span><span class=n>0</span><span class=o>,</span><span class=n>20</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>//告诉浏览器，这个请求用图片的方式打开
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>resp</span><span class=o>.</span><span class=na>setContentType</span><span class=o>(</span><span class=s>&#34;image/jpeg&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=c1>//网站存在缓存，不让浏览器缓存
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>resp</span><span class=o>.</span><span class=na>setDateHeader</span><span class=o>(</span><span class=s>&#34;expires&#34;</span><span class=o>,-</span><span class=n>1</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>resp</span><span class=o>.</span><span class=na>setHeader</span><span class=o>(</span><span class=s>&#34;Cache-Control&#34;</span><span class=o>,</span><span class=s>&#34;no-cache&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>resp</span><span class=o>.</span><span class=na>setHeader</span><span class=o>(</span><span class=s>&#34;Pragma&#34;</span><span class=o>,</span><span class=s>&#34;no-cache&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>//把图片写给浏览器
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>ImageIO</span><span class=o>.</span><span class=na>write</span><span class=o>(</span><span class=n>image</span><span class=o>,</span><span class=s>&#34;jpg&#34;</span><span class=o>,</span> <span class=n>resp</span><span class=o>.</span><span class=na>getOutputStream</span><span class=o>());</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>//生成随机数
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kd>private</span> <span class=n>String</span> <span class=nf>makeNum</span><span class=o>(){</span>
</span></span><span class=line><span class=cl>        <span class=n>Random</span> <span class=n>random</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Random</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=n>String</span> <span class=n>num</span> <span class=o>=</span> <span class=n>random</span><span class=o>.</span><span class=na>nextInt</span><span class=o>(</span><span class=n>9999999</span><span class=o>)</span> <span class=o>+</span> <span class=s>&#34;&#34;</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=n>StringBuffer</span> <span class=n>sb</span> <span class=o>=</span> <span class=k>new</span> <span class=n>StringBuffer</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=o>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=n>0</span><span class=o>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>7</span><span class=o>-</span><span class=n>num</span><span class=o>.</span><span class=na>length</span><span class=o>()</span> <span class=o>;</span> <span class=n>i</span><span class=o>++)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=n>sb</span><span class=o>.</span><span class=na>append</span><span class=o>(</span><span class=s>&#34;0&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=n>num</span> <span class=o>=</span> <span class=n>sb</span><span class=o>.</span><span class=na>toString</span><span class=o>()</span> <span class=o>+</span> <span class=n>num</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>num</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>protected</span> <span class=kt>void</span> <span class=nf>doPost</span><span class=o>(</span><span class=n>HttpServletRequest</span> <span class=n>req</span><span class=o>,</span> <span class=n>HttpServletResponse</span> <span class=n>resp</span><span class=o>)</span>
</span></span><span class=line><span class=cl>        <span class=kd>throws</span> <span class=n>ServletException</span><span class=o>,</span> <span class=n>IOException</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>doGet</span><span class=o>(</span><span class=n>req</span><span class=o>,</span> <span class=n>resp</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;servlet&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;servlet-name&gt;</span>ImageServlet<span class=nt>&lt;/servlet-name&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;servlet-class&gt;</span>com.hjc.servlet.ImageServlet<span class=nt>&lt;/servlet-class&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/servlet&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;servlet-mapping&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;servlet-name&gt;</span>ImageServlet<span class=nt>&lt;/servlet-name&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;url-pattern&gt;</span>/img<span class=nt>&lt;/url-pattern&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/servlet-mapping&gt;</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=4-实现重定向>4. 实现重定向<a hidden class=anchor aria-hidden=true href=#4-实现重定向>#</a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kt>void</span> <span class=nf>sendRedirect</span><span class=o>(</span><span class=n>String</span> <span class=n>var1</span><span class=o>)</span> <span class=kd>throws</span> <span class=n>IOException</span><span class=o>;</span>
</span></span></code></pre></td></tr></table></div></div><p>常见场景</p><ul><li>用户登录</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Override</span>
</span></span><span class=line><span class=cl><span class=kd>protected</span> <span class=kt>void</span> <span class=nf>doGet</span><span class=o>(</span><span class=n>HttpservletRequest</span> <span class=n>req</span><span class=o>,</span> <span class=n>HttpservletResponse</span> <span class=n>resp</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=kd>throws</span> <span class=n>ServletException</span><span class=o>,</span> <span class=n>IOException</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>resp</span><span class=o>.</span><span class=na>sendRedirect</span><span class=o>(</span><span class=s>&#34;/r/img&#34;</span><span class=o>);</span><span class=c1>//重定向
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=cm>/*
</span></span></span><span class=line><span class=cl><span class=cm>    resp.setHeader(&#34;Location&#34;,&#34;/r/img&#34;);
</span></span></span><span class=line><span class=cl><span class=cm>    resp.setstatus(302);
</span></span></span><span class=line><span class=cl><span class=cm>    */</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><p>测试</p><p>index.jsp</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&lt;html&gt;
</span></span><span class=line><span class=cl>    &lt;body&gt;
</span></span><span class=line><span class=cl>        &lt;h2&gt;Hel1o World!&lt;/h2&gt;
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        &lt;%--这里超交的路径,需要寻找到项目的路径--%&gt;
</span></span><span class=line><span class=cl>        &lt;%--${pageContext.request.contextPath}代表当前的项目--%&gt;
</span></span><span class=line><span class=cl>        &lt;form action=&#34;${pageContext.request.contextPath}/login&#34; method=&#34;get&#34;&gt;
</span></span><span class=line><span class=cl>            用户名: &lt;input type=&#34;text&#34; name=&#34;username&#34;&gt; &lt;br&gt;
</span></span><span class=line><span class=cl>            密码: &lt;input type=&#34;password&#34; name=&#34;password&#34;&gt; &lt;br&gt;
</span></span><span class=line><span class=cl>            &lt;input type=&#34;submit&#34;&gt;
</span></span><span class=line><span class=cl>        &lt;/form&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    &lt;/body&gt;
</span></span><span class=line><span class=cl>&lt;/html&gt;
</span></span></code></pre></td></tr></table></div></div><p>RequestTest.java</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>RequestTest</span> <span class=kd>extends</span> <span class=n>HttpServlet</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>protected</span> <span class=kt>void</span> <span class=nf>doGet</span><span class=o>(</span><span class=n>HttpServletRequest</span> <span class=n>req</span><span class=o>,</span> <span class=n>HttpServletResponse</span> <span class=n>resp</span><span class=o>)</span>
</span></span><span class=line><span class=cl>        <span class=kd>throws</span> <span class=n>ServletException</span><span class=o>,</span> <span class=n>IOException</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>//处理方求
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>String</span> <span class=n>username</span> <span class=o>=</span> <span class=n>req</span><span class=o>.</span><span class=na>getParameter</span><span class=o>(</span><span class=s>&#34;username&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>String</span> <span class=n>password</span>  <span class=n>rea</span><span class=o>.</span><span class=na>getParameter</span><span class=o>(</span><span class=s>&#34;password&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>username</span><span class=o>+</span><span class=s>&#34;:&#34;</span><span class=o>+</span><span class=n>password</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>resp</span><span class=o>.</span><span class=na>sendRedirect</span><span class=o>(</span><span class=s>&#34;/r/success.jsp&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><p>success.jsp</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&lt;%@ page contentType=&#34;text/html; charset=UTF-8&#34; language=&#34;java&#34; %&gt;
</span></span><span class=line><span class=cl>&lt;html&gt;
</span></span><span class=line><span class=cl>    &lt;head&gt;
</span></span><span class=line><span class=cl>        &lt;title&gt;Title&lt;/title&gt;
</span></span><span class=line><span class=cl>        &lt;/head&gt;
</span></span><span class=line><span class=cl>    &lt;body&gt;
</span></span><span class=line><span class=cl>        &lt;h1&gt;success&lt;/h1&gt;
</span></span><span class=line><span class=cl>    &lt;/body&gt;
</span></span><span class=line><span class=cl>&lt;/html&gt;
</span></span></code></pre></td></tr></table></div></div><p>web.xml配置</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;servlet&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;servlet-name&gt;</span>requset<span class=nt>&lt;/servlet-name&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;servlet-class&gt;</span>com.hjc.servlet.RequestTest<span class=nt>&lt;/servlet-class&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/servlet&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;servlet-mapping&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;servlet-name&gt;</span>requset<span class=nt>&lt;/servlet-name&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;url-pattern&gt;</span>/login<span class=nt>&lt;/url-pattern&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/servlet-mapping&gt;</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=67-httpservletrequest>6.7 HttpServletRequest<a hidden class=anchor aria-hidden=true href=#67-httpservletrequest>#</a></h3><p>HttpServletRequest代表客户端的请求，用户通过Http协议访问服务器，Http请求中的所有信息都会被封装到HttpServletRequest，通过这个HttpServletRequest的方法获得客户端的所有信息</p><h4 id=1-获取参数>1. 获取参数<a hidden class=anchor aria-hidden=true href=#1-获取参数>#</a></h4><h4 id=2-请求转发>2. 请求转发<a hidden class=anchor aria-hidden=true href=#2-请求转发>#</a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Override</span>
</span></span><span class=line><span class=cl><span class=kd>protected</span> <span class=kt>void</span> <span class=nf>doGet</span><span class=o>(</span><span class=n>HttpservletRequest</span> <span class=n>req</span><span class=o>.</span> <span class=n>HttpservletResponse</span> <span class=n>resp</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=kd>throws</span> <span class=n>ServletException</span><span class=o>,</span> <span class=n>IOException</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>req</span><span class=o>.</span><span class=na>setcharacterEncoding</span><span class=o>(</span><span class=s>&#34;utf-8&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>resp</span><span class=o>.</span><span class=na>setcharacterEncoding</span><span class=o>(</span><span class=s>&#34;utf-8&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>String</span> <span class=n>username</span> <span class=o>=</span> <span class=n>req</span><span class=o>.</span><span class=na>getParameter</span><span class=o>(</span><span class=s>&#34;username&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>String</span> <span class=n>password</span> <span class=o>=</span> <span class=n>req</span><span class=o>.</span><span class=na>getParameter</span><span class=o>(</span><span class=s>&#34;password&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>String</span><span class=o>[]</span> <span class=n>hobbies</span> <span class=o>=</span> <span class=n>req</span><span class=o>.</span><span class=na>getParameterValues</span><span class=o>(</span><span class=s>&#34;hobbys&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;==========&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=c1>//后台接收中文乱码问题
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>username</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>password</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>Arrays</span><span class=o>.</span><span class=na>tostring</span><span class=o>(</span><span class=n>hobbys</span><span class=o>));</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;============&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>system</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>req</span><span class=o>.</span><span class=na>getContextPath</span><span class=o>());</span>
</span></span><span class=line><span class=cl>    <span class=c1>//通过请求转发
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>//这里的/代表当前的web应用
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>req</span><span class=o>.</span><span class=na>getRequestDispatcher</span><span class=o>(</span><span class=s>&#34;/success.jsp&#34;</span><span class=o>).</span><span class=na>forward</span><span class=o>(</span><span class=n>req</span><span class=o>,</span><span class=n>resp</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><h5 id=重定向和和请求转发的区别>重定向和和请求转发的区别<a hidden class=anchor aria-hidden=true href=#重定向和和请求转发的区别>#</a></h5><ul><li>相同点<ul><li>页面都会实现跳转</li></ul></li><li>不同点<ul><li>请求转发的时候，url不会发生变化，是同一个请求</li><li>重定向的时候，url会发生变化，是不同请求</li></ul></li></ul><p><img loading=lazy src=%e9%87%8d%e5%ae%9a%e5%90%91%e4%b8%8e%e8%af%b7%e6%b1%82%e8%bd%ac%e5%8f%91.png alt></p><h2 id=7-cookiesession>7 Cookie、Session<a hidden class=anchor aria-hidden=true href=#7-cookiesession>#</a></h2><h3 id=71-会话>7.1 会话<a hidden class=anchor aria-hidden=true href=#71-会话>#</a></h3><p>会话：用户打开一个浏览器，点击多个超链接，访问多个web资源，关闭浏览器，这个过程可以称为会话</p><p>有状态会话：一个同学来过教室，下次再来教室，我们会知道这个同学，曾经来过，称为有状态会话</p><h3 id=72-保存会话的两种技术>7.2 保存会话的两种技术<a hidden class=anchor aria-hidden=true href=#72-保存会话的两种技术>#</a></h3><p>那么，一个网站，如何证明访问过</p><ul><li>客户端 cookie<ul><li>服务端给客户端一个信件，客户端下次访问服务器带上信件就可以了</li></ul></li><li>服务端 session<ul><li>服务器登记访问过，下次访问的时候匹配登记信息</li></ul></li></ul><p>常见情况：网站登录后，下次访问不用再次登录</p><h3 id=73-cookie>7.3 Cookie<a hidden class=anchor aria-hidden=true href=#73-cookie>#</a></h3><ol><li>从请求中拿到cookie信息</li><li>服务器响应给客户端cookie</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>Cookie</span><span class=o>[]</span> <span class=n>cookies</span> <span class=o>=</span> <span class=n>req</span><span class=o>.</span><span class=na>getCookies</span><span class=o>();</span> <span class=c1>//获得Cookie
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>cookie</span><span class=o>.</span><span class=na>getName</span><span class=o>();</span> <span class=c1>//获得cookie中的key
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>cookie</span><span class=o>.</span><span class=na>getValue</span><span class=o>();</span> <span class=c1>//获得cookie中的vlaue
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>new</span> <span class=n>Cookie</span><span class=o>(</span><span class=s>&#34;lastLoginTime&#34;</span><span class=o>,</span> <span class=n>System</span><span class=o>.</span><span class=na>currentTimeMillis</span><span class=o>()+</span><span class=s>&#34;&#34;</span><span class=o>);</span> <span class=c1>//新建一个cookie
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>cookie</span><span class=o>.</span><span class=na>setMaxAge</span><span class=o>(</span><span class=n>24</span><span class=o>*</span><span class=n>60</span><span class=o>*</span><span class=n>60</span><span class=o>);</span> <span class=c1>//设置cookie的有效期
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>resp</span><span class=o>.</span><span class=na>addCookie</span><span class=o>(</span><span class=n>cookie</span><span class=o>);</span> <span class=c1>//响应给客户端一个cookie
</span></span></span></code></pre></td></tr></table></div></div><p>cookie一般会保存在本地的用户目录下appdata</p><p>一个网站的cookie存在上限</p><ul><li>一个cookie只能保存一个信息</li><li>一个web站点可以给浏览器发送多个cookie，最多存放20个</li><li>cookie大小有限制 4kb</li><li>浏览器有cookie上限 300个</li></ul><ol start=3><li>删除cookie<ul><li>自动删除<ul><li>不设置有效期，关闭浏览器，自动失效</li><li>设置有效时间为0</li></ul></li><li>手动删除</li></ul></li></ol><h3 id=74-session重要>7.4 Session（重要）<a hidden class=anchor aria-hidden=true href=#74-session重要>#</a></h3><ul><li>服务器会给每个用户（浏览器）创建一个Session对象</li><li>一个Session独占一个浏览器，只要浏览器没有关闭，这个Session就存在</li><li>用户登录后，整个网站都可以访问<ul><li>保存用户信息</li><li>保存购物车信息</li></ul></li></ul><p>Session和Cookie的区别</p><ul><li>Cookie是把用户的数据写给用户的浏览器，浏览器保存</li><li>Session是把用户的数据写到用户独占的Session中，服务器保存</li></ul><h4 id=使用session>使用Session<a hidden class=anchor aria-hidden=true href=#使用session>#</a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>SessionDemo</span> <span class=kd>extends</span> <span class=n>HttpServlet</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>protected</span> <span class=kt>void</span> <span class=nf>doGet</span><span class=o>(</span><span class=n>HttpServletRequest</span> <span class=n>req</span><span class=o>,</span> <span class=n>HttpServletResponse</span> <span class=n>resp</span><span class=o>)</span>
</span></span><span class=line><span class=cl>        <span class=kd>throws</span> <span class=n>ServletException</span><span class=o>,</span> <span class=n>IOException</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1>//解决乱码问题
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>req</span><span class=o>.</span><span class=na>setCharacterEncoding</span><span class=o>(</span><span class=s>&#34;UTF-8&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>resp</span><span class=o>.</span><span class=na>setCharacterEncoding</span><span class=o>(</span><span class=s>&#34;UTF-8&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>resp</span><span class=o>.</span><span class=na>setContentType</span><span class=o>(</span><span class=s>&#34;text/html;charset=utf-8&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1>//得到Session
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>HttpSession</span> <span class=n>session</span> <span class=o>=</span> <span class=n>req</span><span class=o>.</span><span class=na>getSession</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=c1>//给Session中存东西
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>session</span><span class=o>.</span><span class=na>setAttribute</span><span class=o>(</span><span class=s>&#34;name&#34;</span><span class=o>,</span><span class=k>new</span> <span class=n>Person</span><span class=o>(</span><span class=s>&#34;admin&#34;</span><span class=o>,</span><span class=n>1</span><span class=o>));</span>
</span></span><span class=line><span class=cl>        <span class=c1>//获取Session的ID
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>String</span> <span class=n>sessionId</span> <span class=o>=</span> <span class=n>session</span><span class=o>.</span><span class=na>getId</span><span class=o>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>//判断Session是不是新创建
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>if</span> <span class=o>(</span><span class=n>session</span><span class=o>.</span><span class=na>isNew</span><span class=o>()){</span>
</span></span><span class=line><span class=cl>            <span class=n>resp</span><span class=o>.</span><span class=na>getWriter</span><span class=o>().</span><span class=na>write</span><span class=o>(</span><span class=s>&#34;session创建成功,ID:&#34;</span><span class=o>+</span><span class=n>sessionId</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span><span class=k>else</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=n>resp</span><span class=o>.</span><span class=na>getWriter</span><span class=o>().</span><span class=na>write</span><span class=o>(</span><span class=s>&#34;session以及在服务器中存在了,ID:&#34;</span><span class=o>+</span><span class=n>sessionId</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>//Session创建的时候做了什么事情；
</span></span></span><span class=line><span class=cl><span class=c1></span>		<span class=c1>//Cookie cookie = new Cookie(&#34;JSESSIONID&#34;,sessionId);
</span></span></span><span class=line><span class=cl><span class=c1></span>		<span class=c1>//resp.addCookie(cookie);
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>protected</span> <span class=kt>void</span> <span class=nf>doPost</span><span class=o>(</span><span class=n>HttpServletRequest</span> <span class=n>req</span><span class=o>,</span> <span class=n>HttpServletResponse</span> <span class=n>resp</span><span class=o>)</span>
</span></span><span class=line><span class=cl>        <span class=kd>throws</span> <span class=n>ServletException</span><span class=o>,</span> <span class=n>IOException</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>doGet</span><span class=o>(</span><span class=n>req</span><span class=o>,</span> <span class=n>resp</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=得到session>得到Session<a hidden class=anchor aria-hidden=true href=#得到session>#</a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>//得到Session
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>HttpSession</span> <span class=n>session</span> <span class=o>=</span> <span class=n>req</span><span class=o>.</span><span class=na>getSession</span><span class=o>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Person</span> <span class=n>person</span> <span class=o>=</span> <span class=o>(</span><span class=n>Person</span><span class=o>)</span> <span class=n>session</span><span class=o>.</span><span class=na>getAttribute</span><span class=o>(</span><span class=s>&#34;name&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>person</span><span class=o>.</span><span class=na>toString</span><span class=o>());</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=注销session>注销Session<a hidden class=anchor aria-hidden=true href=#注销session>#</a></h4><ul><li>手动注销</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>HttpSession</span> <span class=n>session</span> <span class=o>=</span> <span class=n>req</span><span class=o>.</span><span class=na>getSession</span><span class=o>();</span>
</span></span><span class=line><span class=cl><span class=n>session</span><span class=o>.</span><span class=na>removeAttribute</span><span class=o>(</span><span class=s>&#34;name&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=c1>//手动注销Session
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>session</span><span class=o>.</span><span class=na>invalidate</span><span class=o>();</span>
</span></span></code></pre></td></tr></table></div></div><ul><li>自动注销（会话自动过期）</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=c>&lt;!--设置Session默认的失效时间--&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;session-config&gt;</span>
</span></span><span class=line><span class=cl>    <span class=c>&lt;!--15分钟后Session自动失效，以分钟为单位--&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;session-timeout&gt;</span>15<span class=nt>&lt;/session-timeout&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/session-config&gt;</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=8-jsp不重要>8 JSP（不重要）<a hidden class=anchor aria-hidden=true href=#8-jsp不重要>#</a></h2><h3 id=81-什么是jsp>8.1 什么是JSP<a hidden class=anchor aria-hidden=true href=#81-什么是jsp>#</a></h3><p>Java Server Pages：Java服务器端页面，和Servlet一样，用于动态Web技术</p><p>最大的特点</p><ul><li>写JSP就像在写HTML</li><li>区别<ul><li>HTML只给用户提供静态的数据</li><li>JSP页面中可以嵌入Java代码，为用户提供动态数据</li></ul></li></ul><h3 id=82-jsp原理>8.2 JSP原理<a hidden class=anchor aria-hidden=true href=#82-jsp原理>#</a></h3><p>JSP本质上就是一个Servlet，浏览器向服务器发送请求，不管访问什么资源，其实都是在访问Servlet</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>//初始化
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kd>public</span> <span class=kt>void</span> <span class=nf>_jspInit</span><span class=o>()</span> <span class=o>{}</span>
</span></span><span class=line><span class=cl><span class=c1>//销毁
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kd>public</span> <span class=kt>void</span> <span class=nf>_jspDestroy</span><span class=o>()</span> <span class=o>{}</span>
</span></span><span class=line><span class=cl><span class=c1>//JSPService
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kd>public</span> <span class=kt>void</span> <span class=nf>_jspService</span><span class=o>(</span><span class=n>HttpServletRequest</span> <span class=n>request</span><span class=o>,</span> <span class=n>HttpServletResponse</span> <span class=n>response</span><span class=o>)</span> <span class=o>{}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=略>略<a hidden class=anchor aria-hidden=true href=#略>#</a></h3><h2 id=9-javabean>9 JavaBean<a hidden class=anchor aria-hidden=true href=#9-javabean>#</a></h2><p>实体类</p><p>JavaBean有特定的写法</p><ul><li>必须要有一个无参构造函数</li><li>属性必须私有化</li><li>必须有对应的get/set方法</li></ul><p>一般用来和数据库的字段做映射 ORM</p><ul><li>ORM：对象关系映射<ul><li>表 —> 类</li><li>字段 —> 属性</li><li>行记录 —> 对象</li></ul></li></ul><h2 id=10-mvc三层架构>10 MVC三层架构<a hidden class=anchor aria-hidden=true href=#10-mvc三层架构>#</a></h2><p>MVC：Model、View、Controller 模型、视图、控制器</p><h3 id=101-以前的架构>10.1 以前的架构<a hidden class=anchor aria-hidden=true href=#101-以前的架构>#</a></h3><p><img loading=lazy src=%e4%bb%a5%e5%89%8d%e7%9a%84%e6%9e%b6%e6%9e%84.png alt></p><p>用户直接访问控制层，控制层就可以直接操作数据库</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl>servlet--CRUD--&gt;数据库
</span></span><span class=line><span class=cl>弊端：程序十分臃肿，不利于维护  
</span></span><span class=line><span class=cl>servlet的代码中：处理请求、响应、视图跳转、处理JDBC、处理业务代码、处理逻辑代码
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>架构：没有什么是加一层解决不了的！
</span></span><span class=line><span class=cl>程序猿调用
</span></span><span class=line><span class=cl>↑
</span></span><span class=line><span class=cl>JDBC （实现该接口）
</span></span><span class=line><span class=cl>↑
</span></span><span class=line><span class=cl>Mysql/Oracle/SqlServer ....（不同厂商）
</span></span></code></pre></td></tr></table></div></div><h3 id=102-mvc三层架构>10.2 MVC三层架构<a hidden class=anchor aria-hidden=true href=#102-mvc三层架构>#</a></h3><p><img loading=lazy src=MVC.png alt></p><p>Model</p><ul><li>业务处理：实现业务逻辑（Service）</li><li>数据持久层：CRUD（Dao - 数据持久化对象）</li></ul><p>View</p><ul><li>展示数据</li><li>提供链接发起Servlet请求（a、form、img …）</li></ul><p>Controller（Servlet）</p><ul><li>接收用户的请求（req：请求参数、Session信息）</li><li>交给业务层处理对应的代码</li><li>控制视图的跳转</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl>登录 ---&gt; 接收用户的登录请求 ---&gt; 处理用户的请求（获取用户登录的参数，username，password）
</span></span><span class=line><span class=cl>    ---&gt; 交给业务层处理登录业务（判断用户名密码是否正确：事务）
</span></span><span class=line><span class=cl>    ---&gt; Dao层查询用户名和密码是否正确 ---&gt; 数据库
</span></span></code></pre></td></tr></table></div></div><h2 id=11-filter重要>11 Filter（重要）<a hidden class=anchor aria-hidden=true href=#11-filter重要>#</a></h2><p>过滤器，用来过滤网站的数据</p><ul><li>处理中文乱码</li><li>登陆验证</li></ul><p><img loading=lazy src=%e8%bf%87%e6%bb%a4%e5%99%a8.png alt></p><p>Filter开发步骤</p><ol><li><p>导包</p></li><li><p>编写过滤器</p><ol><li>实现Filter接口，重写对应方法</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl> <span class=kd>public</span> <span class=kd>class</span> <span class=nc>CharacterEncodingFilter</span> <span class=kd>implements</span> <span class=n>Filter</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>	<span class=c1>//初始化：web服务器启动，就以及初始化了，随时等待过滤对象出现！
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=kd>public</span> <span class=kt>void</span> <span class=nf>init</span><span class=o>(</span><span class=n>FilterConfig</span> <span class=n>filterConfig</span><span class=o>)</span> <span class=kd>throws</span> <span class=n>ServletException</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>     <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;CharacterEncodingFilter初始化&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>	<span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=c1>//Chain : 链
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=cm>/*
</span></span></span><span class=line><span class=cl><span class=cm>	1. 过滤中的所有代码，在过滤特定请求的时候都会执行
</span></span></span><span class=line><span class=cl><span class=cm>	2. 必须要让过滤器继续同行
</span></span></span><span class=line><span class=cl><span class=cm>        chain.doFilter(request,response);
</span></span></span><span class=line><span class=cl><span class=cm>	*/</span>
</span></span><span class=line><span class=cl>	<span class=kd>public</span> <span class=kt>void</span> <span class=nf>doFilter</span><span class=o>(</span><span class=n>ServletRequest</span> <span class=n>request</span><span class=o>,</span> <span class=n>ServletResponse</span> <span class=n>response</span><span class=o>,</span> <span class=n>FilterChain</span> <span class=n>chain</span><span class=o>)</span>
</span></span><span class=line><span class=cl>         <span class=kd>throws</span> <span class=n>IOException</span><span class=o>,</span> <span class=n>ServletException</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>     <span class=n>request</span><span class=o>.</span><span class=na>setCharacterEncoding</span><span class=o>(</span><span class=s>&#34;utf-8&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>     <span class=n>response</span><span class=o>.</span><span class=na>setCharacterEncoding</span><span class=o>(</span><span class=s>&#34;utf-8&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>     <span class=n>response</span><span class=o>.</span><span class=na>setContentType</span><span class=o>(</span><span class=s>&#34;text/html;charset=UTF-8&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>     <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;CharacterEncodingFilter执行前....&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>     <span class=n>chain</span><span class=o>.</span><span class=na>doFilter</span><span class=o>(</span><span class=n>request</span><span class=o>,</span><span class=n>response</span><span class=o>);</span> <span class=c1>//让请求继续走，如果不写，程序到这里就被拦截停止！
</span></span></span><span class=line><span class=cl><span class=c1></span>     <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;CharacterEncodingFilter执行后....&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>	<span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=c1>//销毁：web服务器关闭的时候，过滤器会销毁
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=kd>public</span> <span class=kt>void</span> <span class=nf>destroy</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>     <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;CharacterEncodingFilter销毁&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>	<span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><ol start=3><li>在web.xml中配置Filter</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;filter&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;filter-name&gt;</span>CharacterEncodingFilter<span class=nt>&lt;/filter-name&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;filter-class&gt;</span>com.hjc.filter.CharacterEncodingFilter<span class=nt>&lt;/filter-class&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/filter&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;filter-mapping&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;filter-name&gt;</span>CharacterEncodingFilter<span class=nt>&lt;/filter-name&gt;</span>
</span></span><span class=line><span class=cl>    <span class=c>&lt;!--只要是 /servlet的任何请求，会经过这个过滤器--&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;url-pattern&gt;</span>/servlet/*<span class=nt>&lt;/url-pattern&gt;</span>
</span></span><span class=line><span class=cl>    <span class=c>&lt;!--&lt;url-pattern&gt;/*&lt;/url-pattern&gt;--&gt;</span>
</span></span><span class=line><span class=cl>    <span class=c>&lt;!-- 别偷懒写个 /* --&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/filter-mapping&gt;</span>
</span></span></code></pre></td></tr></table></div></div></li></ol><h2 id=12-监听器>12 监听器<a hidden class=anchor aria-hidden=true href=#12-监听器>#</a></h2><p>实现一个监听器的接口（有n种监听器）</p><ol><li><p>编写一个监听器</p><ol><li>实现监听器的接口</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>//统计网站在线人数 ： 统计session
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>public</span> <span class=kd>class</span> <span class=nc>OnlineCountListener</span> <span class=kd>implements</span> <span class=n>HttpSessionListener</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>//创建session监听： 看你的一举一动
</span></span></span><span class=line><span class=cl><span class=c1>//一旦创建Session就会触发一次这个事件！
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>public</span> <span class=kt>void</span> <span class=nf>sessionCreated</span><span class=o>(</span><span class=n>HttpSessionEvent</span> <span class=n>se</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>ServletContext</span> <span class=n>ctx</span> <span class=o>=</span> <span class=n>se</span><span class=o>.</span><span class=na>getSession</span><span class=o>().</span><span class=na>getServletContext</span><span class=o>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>se</span><span class=o>.</span><span class=na>getSession</span><span class=o>().</span><span class=na>getId</span><span class=o>());</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>Integer</span> <span class=n>onlineCount</span> <span class=o>=</span> <span class=o>(</span><span class=n>Integer</span><span class=o>)</span> <span class=n>ctx</span><span class=o>.</span><span class=na>getAttribute</span><span class=o>(</span><span class=s>&#34;OnlineCount&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=o>(</span><span class=n>onlineCount</span><span class=o>==</span><span class=kc>null</span><span class=o>){</span>
</span></span><span class=line><span class=cl>        <span class=n>onlineCount</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Integer</span><span class=o>(</span><span class=n>1</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span><span class=k>else</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=kt>int</span> <span class=n>count</span> <span class=o>=</span> <span class=n>onlineCount</span><span class=o>.</span><span class=na>intValue</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=n>onlineCount</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Integer</span><span class=o>(</span><span class=n>count</span><span class=o>+</span><span class=n>1</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>ctx</span><span class=o>.</span><span class=na>setAttribute</span><span class=o>(</span><span class=s>&#34;OnlineCount&#34;</span><span class=o>,</span><span class=n>onlineCount</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>//销毁session监听
</span></span></span><span class=line><span class=cl><span class=c1>//一旦销毁Session就会触发一次这个事件！
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>public</span> <span class=kt>void</span> <span class=nf>sessionDestroyed</span><span class=o>(</span><span class=n>HttpSessionEvent</span> <span class=n>se</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>ServletContext</span> <span class=n>ctx</span> <span class=o>=</span> <span class=n>se</span><span class=o>.</span><span class=na>getSession</span><span class=o>().</span><span class=na>getServletContext</span><span class=o>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>Integer</span> <span class=n>onlineCount</span> <span class=o>=</span> <span class=o>(</span><span class=n>Integer</span><span class=o>)</span> <span class=n>ctx</span><span class=o>.</span><span class=na>getAttribute</span><span class=o>(</span><span class=s>&#34;OnlineCount&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=o>(</span><span class=n>onlineCount</span><span class=o>==</span><span class=kc>null</span><span class=o>){</span>
</span></span><span class=line><span class=cl>        <span class=n>onlineCount</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Integer</span><span class=o>(</span><span class=n>0</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span><span class=k>else</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=kt>int</span> <span class=n>count</span> <span class=o>=</span> <span class=n>onlineCount</span><span class=o>.</span><span class=na>intValue</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=n>onlineCount</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Integer</span><span class=o>(</span><span class=n>count</span><span class=o>-</span><span class=n>1</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>ctx</span><span class=o>.</span><span class=na>setAttribute</span><span class=o>(</span><span class=s>&#34;OnlineCount&#34;</span><span class=o>,</span><span class=n>onlineCount</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=cm>/*
</span></span></span><span class=line><span class=cl><span class=cm>Session销毁：
</span></span></span><span class=line><span class=cl><span class=cm>1. 手动销毁  getSession().invalidate();
</span></span></span><span class=line><span class=cl><span class=cm>2. 自动销毁
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p>在web.xml中注册监听器</p></li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=c>&lt;!--注册监听器--&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;listener&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;listener-class&gt;</span>com.hjc.listener.OnlineCountListener<span class=nt>&lt;/listener-class&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/listener&gt;</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=13-过滤器监听器常见应用>13 过滤器、监听器常见应用<a hidden class=anchor aria-hidden=true href=#13-过滤器监听器常见应用>#</a></h2><h3 id=131-监听器>13.1 监听器<a hidden class=anchor aria-hidden=true href=#131-监听器>#</a></h3><p>GUI编程中常用</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>TestPanel</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>Frame</span> <span class=n>frame</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Frame</span><span class=o>(</span><span class=s>&#34;Test&#34;</span><span class=o>);</span>  <span class=c1>//新建一个窗体
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>Panel</span> <span class=n>panel</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Panel</span><span class=o>(</span><span class=kc>null</span><span class=o>);</span> <span class=c1>//面板
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>frame</span><span class=o>.</span><span class=na>setLayout</span><span class=o>(</span><span class=kc>null</span><span class=o>);</span> <span class=c1>//设置窗体的布局
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>        <span class=n>frame</span><span class=o>.</span><span class=na>setBounds</span><span class=o>(</span><span class=n>300</span><span class=o>,</span><span class=n>300</span><span class=o>,</span><span class=n>500</span><span class=o>,</span><span class=n>500</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>frame</span><span class=o>.</span><span class=na>setBackground</span><span class=o>(</span><span class=k>new</span> <span class=n>Color</span><span class=o>(</span><span class=n>0</span><span class=o>,</span><span class=n>0</span><span class=o>,</span><span class=n>255</span><span class=o>));</span> <span class=c1>//设置背景颜色
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>        <span class=n>panel</span><span class=o>.</span><span class=na>setBounds</span><span class=o>(</span><span class=n>50</span><span class=o>,</span><span class=n>50</span><span class=o>,</span><span class=n>300</span><span class=o>,</span><span class=n>300</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>panel</span><span class=o>.</span><span class=na>setBackground</span><span class=o>(</span><span class=k>new</span> <span class=n>Color</span><span class=o>(</span><span class=n>0</span><span class=o>,</span><span class=n>255</span><span class=o>,</span><span class=n>0</span><span class=o>));</span> <span class=c1>//设置背景颜色
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>        <span class=n>frame</span><span class=o>.</span><span class=na>add</span><span class=o>(</span><span class=n>panel</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>frame</span><span class=o>.</span><span class=na>setVisible</span><span class=o>(</span><span class=kc>true</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>//监听事件，监听关闭事件
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>frame</span><span class=o>.</span><span class=na>addWindowListener</span><span class=o>(</span><span class=k>new</span> <span class=n>WindowAdapter</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>            <span class=kd>public</span> <span class=kt>void</span> <span class=nf>windowClosing</span><span class=o>(</span><span class=n>WindowEvent</span> <span class=n>e</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=kd>super</span><span class=o>.</span><span class=na>windowClosing</span><span class=o>(</span><span class=n>e</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=o>});</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=132-过滤器>13.2 过滤器<a hidden class=anchor aria-hidden=true href=#132-过滤器>#</a></h3><p>用户登陆后才能进入主页，用户注销后就不能进入主页</p><ol><li>用户登录后，向Session中放入用户的数据</li><li>进入主页的时候要判断用户是否已经登陆，在过滤器中实现</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kt>void</span> <span class=nf>doFilter</span><span class=o>(</span><span class=n>ServletRequest</span> <span class=n>request</span><span class=o>,</span> <span class=n>ServletResponse</span> <span class=n>response</span><span class=o>,</span> <span class=n>FilterChain</span> <span class=n>chain</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=kd>throws</span> <span class=n>IOException</span><span class=o>,</span> <span class=n>ServletException</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>HttpServletRequest</span> <span class=n>request</span> <span class=o>=</span> <span class=o>(</span><span class=n>HttpServletRequest</span><span class=o>)</span> <span class=n>req</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=n>HttpServletResponse</span> <span class=n>response</span> <span class=o>=</span> <span class=o>(</span><span class=n>HttpServletResponse</span><span class=o>)</span> <span class=n>resp</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=o>(</span><span class=n>request</span><span class=o>.</span><span class=na>getSession</span><span class=o>().</span><span class=na>getAttribute</span><span class=o>(</span><span class=n>Constant</span><span class=o>.</span><span class=na>USER_SESSION</span><span class=o>)==</span><span class=kc>null</span><span class=o>){</span>
</span></span><span class=line><span class=cl>        <span class=n>response</span><span class=o>.</span><span class=na>sendRedirect</span><span class=o>(</span><span class=s>&#34;/error.jsp&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>chain</span><span class=o>.</span><span class=na>doFilter</span><span class=o>(</span><span class=n>request</span><span class=o>,</span><span class=n>response</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=14-jdbc>14 JDBC<a hidden class=anchor aria-hidden=true href=#14-jdbc>#</a></h2><p><img loading=lazy src=JDBC.png alt></p><h3 id=141-jdbc固定步骤>14.1 JDBC固定步骤<a hidden class=anchor aria-hidden=true href=#141-jdbc固定步骤>#</a></h3><ol><li>加载驱动</li><li>连接数据库</li><li>向数据库发送sql的对象Statement：CRUD</li><li>编写sql</li><li>执行sql</li><li>关闭连接（注意先后顺序）</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>TestJDBC</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=kd>throws</span> <span class=n>ClassNotFoundException</span><span class=o>,</span> <span class=n>SQLException</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>//配置信息
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=c1>//useUnicode=true&amp;characterEncoding=utf-8 解决中文乱码
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>String</span> <span class=n>url</span><span class=o>=</span><span class=s>&#34;jdbc:mysql://localhost:3306/jdbc?useUnicode=true&amp;characterEncoding=utf-8&#34;</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=n>String</span> <span class=n>username</span> <span class=o>=</span> <span class=s>&#34;root&#34;</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=n>String</span> <span class=n>password</span> <span class=o>=</span> <span class=s>&#34;123456&#34;</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>//1.加载驱动
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>Class</span><span class=o>.</span><span class=na>forName</span><span class=o>(</span><span class=s>&#34;com.mysql.jdbc.Driver&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=c1>//2.连接数据库,代表数据库
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>Connection</span> <span class=n>connection</span> <span class=o>=</span> <span class=n>DriverManager</span><span class=o>.</span><span class=na>getConnection</span><span class=o>(</span><span class=n>url</span><span class=o>,</span> <span class=n>username</span><span class=o>,</span> <span class=n>password</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>//3.向数据库发送SQL的对象Statement,PreparedStatement : CRUD
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>Statement</span> <span class=n>statement</span> <span class=o>=</span> <span class=n>connection</span><span class=o>.</span><span class=na>createStatement</span><span class=o>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>//4.编写SQL
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>String</span> <span class=n>sql</span> <span class=o>=</span> <span class=s>&#34;select * from users&#34;</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>//5.执行查询SQL，返回一个 ResultSet  ： 结果集
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>ResultSet</span> <span class=n>rs</span> <span class=o>=</span> <span class=n>statement</span><span class=o>.</span><span class=na>executeQuery</span><span class=o>(</span><span class=n>sql</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>while</span> <span class=o>(</span><span class=n>rs</span><span class=o>.</span><span class=na>next</span><span class=o>()){</span>
</span></span><span class=line><span class=cl>            <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;id=&#34;</span><span class=o>+</span><span class=n>rs</span><span class=o>.</span><span class=na>getObject</span><span class=o>(</span><span class=s>&#34;id&#34;</span><span class=o>));</span>
</span></span><span class=line><span class=cl>            <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;name=&#34;</span><span class=o>+</span><span class=n>rs</span><span class=o>.</span><span class=na>getObject</span><span class=o>(</span><span class=s>&#34;name&#34;</span><span class=o>));</span>
</span></span><span class=line><span class=cl>            <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;password=&#34;</span><span class=o>+</span><span class=n>rs</span><span class=o>.</span><span class=na>getObject</span><span class=o>(</span><span class=s>&#34;password&#34;</span><span class=o>));</span>
</span></span><span class=line><span class=cl>            <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;email=&#34;</span><span class=o>+</span><span class=n>rs</span><span class=o>.</span><span class=na>getObject</span><span class=o>(</span><span class=s>&#34;email&#34;</span><span class=o>));</span>
</span></span><span class=line><span class=cl>            <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;birthday=&#34;</span><span class=o>+</span><span class=n>rs</span><span class=o>.</span><span class=na>getObject</span><span class=o>(</span><span class=s>&#34;birthday&#34;</span><span class=o>));</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>//6.关闭连接，释放资源（一定要做） 先开后关
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>rs</span><span class=o>.</span><span class=na>close</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=n>statement</span><span class=o>.</span><span class=na>close</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=n>connection</span><span class=o>.</span><span class=na>close</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><p>预编译sql</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>TestJDBC2</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=kd>throws</span> <span class=n>Exception</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>//配置信息
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=c1>//useUnicode=true&amp;characterEncoding=utf-8 解决中文乱码
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>String</span> <span class=n>url</span><span class=o>=</span><span class=s>&#34;jdbc:mysql://localhost:3306/jdbc?useUnicode=true&amp;characterEncoding=utf-8&#34;</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=n>String</span> <span class=n>username</span> <span class=o>=</span> <span class=s>&#34;root&#34;</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=n>String</span> <span class=n>password</span> <span class=o>=</span> <span class=s>&#34;123456&#34;</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>//1.加载驱动
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>Class</span><span class=o>.</span><span class=na>forName</span><span class=o>(</span><span class=s>&#34;com.mysql.jdbc.Driver&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=c1>//2.连接数据库,代表数据库
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>Connection</span> <span class=n>connection</span> <span class=o>=</span> <span class=n>DriverManager</span><span class=o>.</span><span class=na>getConnection</span><span class=o>(</span><span class=n>url</span><span class=o>,</span> <span class=n>username</span><span class=o>,</span> <span class=n>password</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>//3.编写SQL
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>String</span> <span class=n>sql</span> <span class=o>=</span> <span class=s>&#34;insert into  users(id, name, password, email, birthday) values (?,?,?,?,?);&#34;</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>//4.预编译
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>PreparedStatement</span> <span class=n>preparedStatement</span> <span class=o>=</span> <span class=n>connection</span><span class=o>.</span><span class=na>prepareStatement</span><span class=o>(</span><span class=n>sql</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>preparedStatement</span><span class=o>.</span><span class=na>setInt</span><span class=o>(</span><span class=n>1</span><span class=o>,</span><span class=n>1</span><span class=o>);</span><span class=c1>//给第一个占位符？的值赋值为1
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>preparedStatement</span><span class=o>.</span><span class=na>setString</span><span class=o>(</span><span class=n>2</span><span class=o>,</span><span class=s>&#34;admin&#34;</span><span class=o>);</span><span class=c1>//给第二个占位符？的值赋值为admin
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>preparedStatement</span><span class=o>.</span><span class=na>setString</span><span class=o>(</span><span class=n>3</span><span class=o>,</span><span class=s>&#34;123456&#34;</span><span class=o>);</span><span class=c1>//给第三个占位符？的值赋值为123456
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>preparedStatement</span><span class=o>.</span><span class=na>setString</span><span class=o>(</span><span class=n>4</span><span class=o>,</span><span class=s>&#34;admin@gmail.com&#34;</span><span class=o>);</span><span class=c1>//给第四个占位符？的值赋值为admin@gmail.com
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>preparedStatement</span><span class=o>.</span><span class=na>setDate</span><span class=o>(</span><span class=n>5</span><span class=o>,</span><span class=k>new</span> <span class=n>Date</span><span class=o>(</span><span class=k>new</span> <span class=n>java</span><span class=o>.</span><span class=na>util</span><span class=o>.</span><span class=na>Date</span><span class=o>().</span><span class=na>getTime</span><span class=o>()));</span>
</span></span><span class=line><span class=cl>        <span class=c1>//给第五个占位符？的值赋值为new Date(new java.util.Date().getTime())
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>        <span class=c1>//5.执行SQL
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=n>preparedStatement</span><span class=o>.</span><span class=na>executeUpdate</span><span class=o>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=o>(</span><span class=n>i</span><span class=o>&gt;</span><span class=n>0</span><span class=o>){</span>
</span></span><span class=line><span class=cl>            <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;插入成功@&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>//6.关闭连接，释放资源（一定要做） 先开后关
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>preparedStatement</span><span class=o>.</span><span class=na>close</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=n>connection</span><span class=o>.</span><span class=na>close</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=142-事务>14.2 事务<a hidden class=anchor aria-hidden=true href=#142-事务>#</a></h3><p>要么都成功，要么都失败，ACID原则：保证数据的安全</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://h-jch.github.io/tags/java/>java</a></li><li><a href=https://h-jch.github.io/tags/servlet/>servlet</a></li><li><a href=https://h-jch.github.io/tags/web/>web</a></li></ul><nav class=paginav><a class=prev href=https://h-jch.github.io/posts/code/study-mybatis/><span class=title>« Prev</span><br><span>MyBatis学习笔记</span></a>
<a class=next href=https://h-jch.github.io/posts/code/topsort/><span class=title>Next »</span><br><span>拓扑排序</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://h-jch.github.io>Kei's Blog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>