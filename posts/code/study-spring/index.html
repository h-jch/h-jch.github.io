<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Spring学习笔记 | Kei's Blog</title><meta name=keywords content="java,spring"><meta name=description content="1 简介 1.1 历史 Spring框架以interface21框架为基础，经过重新设计，并不断丰富其内涵，与2004年3月24日发布了1.0正式版 作者"><meta name=author content="kei"><link rel=canonical href=https://h-jch.github.io/posts/code/study-spring/><link crossorigin=anonymous href=/assets/css/stylesheet.678b5c47efa744d2e0dd0d61101075e6aecdc9a0631e7ad8538f4ec0cca79273.css integrity="sha256-Z4tcR++nRNLg3Q1hEBB15q7NyaBjHnrYU49OwMynknM=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://h-jch.github.io/images/avatar.png><link rel=icon type=image/png sizes=16x16 href=https://h-jch.github.io/images/avatar.png><link rel=icon type=image/png sizes=32x32 href=https://h-jch.github.io/images/avatar.png><link rel=apple-touch-icon href=https://h-jch.github.io/images/avatar.png><link rel=mask-icon href=https://h-jch.github.io/images/avatar.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Spring学习笔记"><meta property="og:description" content="1 简介 1.1 历史 Spring框架以interface21框架为基础，经过重新设计，并不断丰富其内涵，与2004年3月24日发布了1.0正式版 作者"><meta property="og:type" content="article"><meta property="og:url" content="https://h-jch.github.io/posts/code/study-spring/"><meta property="og:image" content="https://h-jch.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-07-16T17:57:24+08:00"><meta property="article:modified_time" content="2020-07-16T17:57:24+08:00"><meta property="og:site_name" content="Kei's Blog"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://h-jch.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="Spring学习笔记"><meta name=twitter:description content="1 简介 1.1 历史 Spring框架以interface21框架为基础，经过重新设计，并不断丰富其内涵，与2004年3月24日发布了1.0正式版 作者"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://h-jch.github.io/posts/"},{"@type":"ListItem","position":3,"name":"Spring学习笔记","item":"https://h-jch.github.io/posts/code/study-spring/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Spring学习笔记","name":"Spring学习笔记","description":"1 简介 1.1 历史 Spring框架以interface21框架为基础，经过重新设计，并不断丰富其内涵，与2004年3月24日发布了1.0正式版 作者","keywords":["java","spring"],"articleBody":"1 简介 1.1 历史 Spring框架以interface21框架为基础，经过重新设计，并不断丰富其内涵，与2004年3月24日发布了1.0正式版\n作者为Rod Johnson\n1.2 理念 使现有的技术更加容易使用 本身包括很多内容，并整合了现有的技术框架 1.3 优点 Spring是一个开源的免费的框架（容器） Spring是一个轻量级的、非入侵式的框架 控制反转（IOC） 面向切面编程（AOP） 支持事务的处理 1.4 组成 1.5 其他 Spring Boot 一个快速开发的框架 基于Spring Boot可以快速开发单个微服务 Spring Cloud 基于Spring Boot实现 2 IoC 以前的JavaWeb项目开发流程，比如\n写UserDao接口 1 2 3 public interface UserDao { //方法 } 写UserDaoImpl实现类 1 2 3 public class UserDaoImpl implements UserDao { //方法实现 } 写UserService业务接口 1 2 3 public interface UserService { //方法 } 写UserServiceImpl业务实现类 1 2 3 4 5 public class UserServiceImpl implements UserService { private UserDao userDao = new UserDaoImpl(); //方法实现 } 测试 1 2 3 4 5 @Test public void test() { UserService userService = new UserServiceImpl(); //调用userService的方法 } 这种方法的弊端在于用户的需求可能会影响代码，需要根据用户需求去修改代码，代价很大\n那么，如果在UserServiceImpl中使用set接口，程序变为\n1 2 3 4 5 6 7 8 9 public class UserServiceImpl implements UserService { private UserDao userDao; //利用set进行动态注入 public void setUserDao(UserDao userDao) { this.userDao = userDao; } //方法实现 } 测试的时候代码变为\n1 2 3 4 5 6 @Test public void test() { UserService userService = new UserServiceImpl(); (UserServiceImpl) userService.setUserDao(new UserDaoImpl()); //调用userService的方法 } 使用set注入后，程序不再具有主动性，变成了被动的接收对象。主动权转到了用户，用户选择实现类对象\n这种思想从本质上解决了问题，程序员不用管理对象的创建，降低了系统的耦合，从而专注业务的实现，这就是IoC的原型\n2.1 IoC本质 控制反转（IoC, Inversion of Control）是一种设计思想。在没有IoC的程序中，使用面向对象编程，对象的创建和对象间的依赖关系完全硬编码在程序中，对象的创建由程序自己控制。而控制反转则是将对象的创建转移给第三方\n控制反转是一种通过描述（XML或注解）并通过第三方去生产或获取特定对象的方式，在Spring中实现控制反转的是IoC容器，其实现方法是依赖注入（DI, Dependency Injection）\n3 HelloSpring 编写实体类 1 2 3 4 5 6 7 8 9 10 11 public class Hello { private String str; public void setStr(String str) { this.str = str; } public String getStr() { return str; } } 配置xml文件 1 2 3 ","wordCount":"6905","inLanguage":"en","datePublished":"2020-07-16T17:57:24+08:00","dateModified":"2020-07-16T17:57:24+08:00","author":[{"@type":"Person","name":"kei"}],"mainEntityOfPage":{"@type":"WebPage","@id":"https://h-jch.github.io/posts/code/study-spring/"},"publisher":{"@type":"Organization","name":"Kei's Blog","logo":{"@type":"ImageObject","url":"https://h-jch.github.io/images/avatar.png"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://h-jch.github.io accesskey=h title="Kei's Blog (Alt + H)"><img src=https://h-jch.github.io/images/avatar.png alt aria-label=logo height=35>Kei's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://h-jch.github.io/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://h-jch.github.io/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://h-jch.github.io/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://h-jch.github.io/about/ title=About><span>About</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>Spring学习笔记</h1><div class=post-meta><span title='2020-07-16 17:57:24 +0800 CST'>2020-07-16</span>&nbsp;·&nbsp;14 min&nbsp;·&nbsp;6905 words&nbsp;·&nbsp;kei</div></header><aside id=toc-container class="toc-container wide"><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#1-%e7%ae%80%e4%bb%8b aria-label="1 简介">1 简介</a><ul><li><a href=#11-%e5%8e%86%e5%8f%b2 aria-label="1.1 历史">1.1 历史</a></li><li><a href=#12-%e7%90%86%e5%bf%b5 aria-label="1.2 理念">1.2 理念</a></li><li><a href=#13-%e4%bc%98%e7%82%b9 aria-label="1.3 优点">1.3 优点</a></li><li><a href=#14-%e7%bb%84%e6%88%90 aria-label="1.4 组成">1.4 组成</a></li><li><a href=#15-%e5%85%b6%e4%bb%96 aria-label="1.5 其他">1.5 其他</a></li></ul></li><li><a href=#2-ioc aria-label="2 IoC">2 IoC</a><ul><li><a href=#21-ioc%e6%9c%ac%e8%b4%a8 aria-label="2.1 IoC本质">2.1 IoC本质</a></li></ul></li><li><a href=#3-hellospring aria-label="3 HelloSpring">3 HelloSpring</a></li><li><a href=#4-ioc%e5%88%9b%e5%bb%ba%e5%af%b9%e8%b1%a1%e7%9a%84%e6%96%b9%e5%bc%8f aria-label="4 IoC创建对象的方式">4 IoC创建对象的方式</a><ul><li><a href=#41-%e6%97%a0%e5%8f%82%e6%9e%84%e9%80%a0%e5%87%bd%e6%95%b0%e5%88%9b%e5%bb%ba%e5%af%b9%e8%b1%a1 aria-label="4.1 无参构造函数创建对象">4.1 无参构造函数创建对象</a></li><li><a href=#42-%e6%9c%89%e5%8f%82%e6%9e%84%e9%80%a0%e5%87%bd%e6%95%b0%e5%88%9b%e5%bb%ba%e5%af%b9%e8%b1%a1 aria-label="4.2 有参构造函数创建对象">4.2 有参构造函数创建对象</a></li></ul></li><li><a href=#5-spring%e9%85%8d%e7%bd%ae aria-label="5 Spring配置">5 Spring配置</a><ul><li><a href=#51-%e5%88%ab%e5%90%8d aria-label="5.1 别名">5.1 别名</a></li><li><a href=#52-bean%e7%9a%84%e9%85%8d%e7%bd%ae aria-label="5.2 bean的配置">5.2 bean的配置</a></li><li><a href=#53-%e4%bd%bf%e7%94%a8import aria-label="5.3 使用import">5.3 使用import</a></li></ul></li><li><a href=#6-%e4%be%9d%e8%b5%96%e6%b3%a8%e5%85%a5 aria-label="6 依赖注入">6 依赖注入</a><ul><li><a href=#61-%e6%9e%84%e9%80%a0%e5%99%a8%e6%b3%a8%e5%85%a5 aria-label="6.1 构造器注入">6.1 构造器注入</a></li><li><a href=#62-set%e6%96%b9%e5%bc%8f%e6%b3%a8%e5%85%a5 aria-label="6.2 set方式注入">6.2 set方式注入</a></li><li><a href=#63-%e5%85%b6%e4%bb%96%e6%96%b9%e5%bc%8f%e6%b3%a8%e5%85%a5 aria-label="6.3 其他方式注入">6.3 其他方式注入</a></li></ul></li><li><a href=#7-bean%e7%9a%84%e4%bd%9c%e7%94%a8%e5%9f%9f aria-label="7 bean的作用域">7 bean的作用域</a><ul><li><a href=#71-singleton aria-label="7.1 singleton">7.1 singleton</a></li><li><a href=#72-prototype aria-label="7.2 prototype">7.2 prototype</a></li><li><a href=#73-requestsessionapplication aria-label="7.3 request、session、application">7.3 request、session、application</a></li></ul></li><li><a href=#8-bean%e7%9a%84%e8%87%aa%e5%8a%a8%e8%a3%85%e9%85%8d aria-label="8 bean的自动装配">8 bean的自动装配</a><ul><li><a href=#81-byname%e8%87%aa%e5%8a%a8%e8%a3%85%e9%85%8d aria-label="8.1 byName自动装配">8.1 byName自动装配</a></li><li><a href=#82-bytype%e8%87%aa%e5%8a%a8%e8%a3%85%e9%85%8d aria-label="8.2 byType自动装配">8.2 byType自动装配</a></li><li><a href=#83-%e6%b3%a8%e8%a7%a3%e8%87%aa%e5%8a%a8%e8%a3%85%e9%85%8d aria-label="8.3 注解自动装配">8.3 注解自动装配</a></li></ul></li><li><a href=#9-%e4%bd%bf%e7%94%a8%e6%b3%a8%e8%a7%a3%e5%bc%80%e5%8f%91 aria-label="9 使用注解开发">9 使用注解开发</a><ul><li><a href=#91-component aria-label="9.1 @Component">9.1 @Component</a></li><li><a href=#92-value aria-label="9.2 @Value">9.2 @Value</a></li><li><a href=#93-component%e7%9a%84%e8%a1%8d%e7%94%9f%e6%b3%a8%e8%a7%a3 aria-label="9.3 @Component的衍生注解">9.3 @Component的衍生注解</a></li><li><a href=#94-autowired aria-label="9.4 @Autowired">9.4 @Autowired</a></li><li><a href=#95-scope aria-label="9.5 @Scope">9.5 @Scope</a></li></ul></li><li><a href=#10-%e4%bd%bf%e7%94%a8javaconfig%e9%85%8d%e7%bd%ae aria-label="10 使用JavaConfig配置">10 使用JavaConfig配置</a><ul><li><a href=#101-configurationbean aria-label="10.1 @Configuration、@Bean">10.1 @Configuration、@Bean</a></li><li><a href=#102-componentscan aria-label="10.2 @ComponentScan">10.2 @ComponentScan</a></li></ul></li><li><a href=#11-%e4%bb%a3%e7%90%86%e6%a8%a1%e5%bc%8f aria-label="11 代理模式">11 代理模式</a><ul><li><a href=#111-%e9%9d%99%e6%80%81%e4%bb%a3%e7%90%86 aria-label="11.1 静态代理">11.1 静态代理</a></li><li><a href=#112-%e5%8a%a8%e6%80%81%e4%bb%a3%e7%90%86 aria-label="11.2 动态代理">11.2 动态代理</a></li></ul></li><li><a href=#12-aop aria-label="12 AOP">12 AOP</a><ul><li><a href=#121aop%e5%ae%9a%e4%b9%89 aria-label=12.1AOP定义>12.1AOP定义</a></li><li><a href=#122-aop%e5%9c%a8spring%e4%b8%ad%e7%9a%84%e4%bd%9c%e7%94%a8 aria-label="12.2 AOP在Spring中的作用">12.2 AOP在Spring中的作用</a></li><li><a href=#113-%e4%bd%bf%e7%94%a8spring%e5%ae%9e%e7%8e%b0aop aria-label="11.3 使用Spring实现AOP">11.3 使用Spring实现AOP</a></li></ul></li><li><a href=#13-%e6%95%b4%e5%90%88mybatis aria-label="13 整合MyBatis">13 整合MyBatis</a><ul><li><a href=#131-mybatis aria-label="13.1 MyBatis">13.1 MyBatis</a></li><li><a href=#132-mybatis-spring aria-label="13.2 MyBatis-Spring">13.2 MyBatis-Spring</a></li></ul></li><li><a href=#14-%e5%a3%b0%e6%98%8e%e5%bc%8f%e4%ba%8b%e5%8a%a1 aria-label="14 声明式事务">14 声明式事务</a></li><li><a href=#141-%e4%ba%8b%e5%8a%a1 aria-label="14.1 事务">14.1 事务</a><ul><li><a href=#142-spring%e4%b8%ad%e7%9a%84%e4%ba%8b%e5%8a%a1%e7%ae%a1%e7%90%86 aria-label="14.2 Spring中的事务管理">14.2 Spring中的事务管理</a></li></ul></li></ul></div></details></div></aside><script>let activeElement,elements;window.addEventListener("DOMContentLoaded",function(){checkTocPosition(),elements=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]"),activeElement=elements[0];const t=encodeURI(activeElement.getAttribute("id")).toLowerCase();document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active")},!1),window.addEventListener("resize",function(){checkTocPosition()},!1),window.addEventListener("scroll",()=>{activeElement=Array.from(elements).find(e=>{if(getOffsetTop(e)-window.pageYOffset>0&&getOffsetTop(e)-window.pageYOffset<window.innerHeight/2)return e})||activeElement,elements.forEach(e=>{const t=encodeURI(e.getAttribute("id")).toLowerCase();e===activeElement?document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active"):document.querySelector(`.inner ul li a[href="#${t}"]`).classList.remove("active")})},!1);const main=parseInt(getComputedStyle(document.body).getPropertyValue("--article-width"),10),toc=parseInt(getComputedStyle(document.body).getPropertyValue("--toc-width"),10),gap=parseInt(getComputedStyle(document.body).getPropertyValue("--gap"),10);function checkTocPosition(){const e=document.body.scrollWidth;e-main-toc*2-gap*4>0?document.getElementById("toc-container").classList.add("wide"):document.getElementById("toc-container").classList.remove("wide")}function getOffsetTop(e){if(!e.getClientRects().length)return 0;let t=e.getBoundingClientRect(),n=e.ownerDocument.defaultView;return t.top+n.pageYOffset}</script><div class=post-content><h2 id=1-简介>1 简介<a hidden class=anchor aria-hidden=true href=#1-简介>#</a></h2><h3 id=11-历史>1.1 历史<a hidden class=anchor aria-hidden=true href=#11-历史>#</a></h3><ul><li><p>Spring框架以interface21框架为基础，经过重新设计，并不断丰富其内涵，与2004年3月24日发布了1.0正式版</p></li><li><p>作者为Rod Johnson</p></li></ul><h3 id=12-理念>1.2 理念<a hidden class=anchor aria-hidden=true href=#12-理念>#</a></h3><ul><li>使现有的技术更加容易使用</li><li>本身包括很多内容，并整合了现有的技术框架</li></ul><h3 id=13-优点>1.3 优点<a hidden class=anchor aria-hidden=true href=#13-优点>#</a></h3><ul><li>Spring是一个开源的免费的框架（容器）</li><li>Spring是一个轻量级的、非入侵式的框架</li><li>控制反转（IOC）</li><li>面向切面编程（AOP）</li><li>支持事务的处理</li></ul><h3 id=14-组成>1.4 组成<a hidden class=anchor aria-hidden=true href=#14-组成>#</a></h3><p><img loading=lazy src=spring%e6%a8%a1%e5%9d%97.jpg alt></p><h3 id=15-其他>1.5 其他<a hidden class=anchor aria-hidden=true href=#15-其他>#</a></h3><ul><li>Spring Boot<ul><li>一个快速开发的框架</li><li>基于Spring Boot可以快速开发单个微服务</li></ul></li><li>Spring Cloud<ul><li>基于Spring Boot实现</li></ul></li></ul><h2 id=2-ioc>2 IoC<a hidden class=anchor aria-hidden=true href=#2-ioc>#</a></h2><p>以前的JavaWeb项目开发流程，比如</p><ol><li>写UserDao接口</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>interface</span> <span class=nc>UserDao</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>//方法
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><ol start=2><li>写UserDaoImpl实现类</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>UserDaoImpl</span> <span class=kd>implements</span> <span class=n>UserDao</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>//方法实现
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><ol start=3><li>写UserService业务接口</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>interface</span> <span class=nc>UserService</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>//方法
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><ol start=4><li>写UserServiceImpl业务实现类</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>UserServiceImpl</span> <span class=kd>implements</span> <span class=n>UserService</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>UserDao</span> <span class=n>userDao</span> <span class=o>=</span> <span class=k>new</span> <span class=n>UserDaoImpl</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>//方法实现
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><ol start=5><li>测试</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Test</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kt>void</span> <span class=nf>test</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>UserService</span> <span class=n>userService</span> <span class=o>=</span> <span class=k>new</span> <span class=n>UserServiceImpl</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=c1>//调用userService的方法
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><p>这种方法的弊端在于用户的需求可能会影响代码，需要根据用户需求去修改代码，代价很大</p><p>那么，如果在UserServiceImpl中使用set接口，程序变为</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>UserServiceImpl</span> <span class=kd>implements</span> <span class=n>UserService</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>UserDao</span> <span class=n>userDao</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=c1>//利用set进行动态注入
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>setUserDao</span><span class=o>(</span><span class=n>UserDao</span> <span class=n>userDao</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=o>.</span><span class=na>userDao</span> <span class=o>=</span> <span class=n>userDao</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>//方法实现
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><p>测试的时候代码变为</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Test</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kt>void</span> <span class=nf>test</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>UserService</span> <span class=n>userService</span> <span class=o>=</span> <span class=k>new</span> <span class=n>UserServiceImpl</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=o>(</span><span class=n>UserServiceImpl</span><span class=o>)</span> <span class=n>userService</span><span class=o>.</span><span class=na>setUserDao</span><span class=o>(</span><span class=k>new</span> <span class=n>UserDaoImpl</span><span class=o>());</span>
</span></span><span class=line><span class=cl>    <span class=c1>//调用userService的方法
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><p>使用set注入后，程序不再具有主动性，变成了被动的接收对象。主动权转到了用户，用户选择实现类对象</p><p>这种思想从本质上解决了问题，程序员不用管理对象的创建，降低了系统的耦合，从而专注业务的实现，这就是IoC的原型</p><h3 id=21-ioc本质>2.1 IoC本质<a hidden class=anchor aria-hidden=true href=#21-ioc本质>#</a></h3><p>控制反转（IoC, Inversion of Control）是一种设计思想。在没有IoC的程序中，使用面向对象编程，对象的创建和对象间的依赖关系完全硬编码在程序中，对象的创建由程序自己控制。而控制反转则是将对象的创建转移给第三方</p><p>控制反转是一种通过描述（XML或注解）并通过第三方去生产或获取特定对象的方式，在Spring中实现控制反转的是IoC容器，其实现方法是依赖注入（DI, Dependency Injection）</p><h2 id=3-hellospring>3 HelloSpring<a hidden class=anchor aria-hidden=true href=#3-hellospring>#</a></h2><ol><li>编写实体类</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Hello</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>String</span> <span class=n>str</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>setStr</span><span class=o>(</span><span class=n>String</span> <span class=n>str</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=o>.</span><span class=na>str</span> <span class=o>=</span> <span class=n>str</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>String</span> <span class=nf>getStr</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>str</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><ol start=2><li>配置xml文件</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;bean</span> <span class=na>id=</span><span class=s>&#34;hello&#34;</span> <span class=na>class=</span><span class=s>&#34;com.hjc.pojo.Hello&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;property</span> <span class=na>name=</span><span class=s>&#34;str&#34;</span> <span class=na>value=</span><span class=s>&#34;Hello, world&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/bean&gt;</span>
</span></span></code></pre></td></tr></table></div></div><ol start=3><li>测试</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Test</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kt>void</span> <span class=nf>test</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>ApplicationContext</span> <span class=n>context</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ClassPathXmlApplicationContext</span><span class=o>(</span><span class=s>&#34;beans.xml&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>Hello</span> <span class=n>hello</span> <span class=o>=</span> <span class=o>(</span><span class=n>Hello</span><span class=o>)</span> <span class=n>context</span><span class=o>.</span><span class=na>getBean</span><span class=o>(</span><span class=s>&#34;hello&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>hello</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><p>要实现不同的操作，我们只需要在xml文件中修改。对象由Spring来创建，管理，装配</p><h2 id=4-ioc创建对象的方式>4 IoC创建对象的方式<a hidden class=anchor aria-hidden=true href=#4-ioc创建对象的方式>#</a></h2><h3 id=41-无参构造函数创建对象>4.1 无参构造函数创建对象<a hidden class=anchor aria-hidden=true href=#41-无参构造函数创建对象>#</a></h3><p>要用无参构造函数创建对象，那么类中就要保留无参构造函数，要么显示写出无参构造函数，要么就不写构造函数</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>User</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kt>int</span> <span class=n>id</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>String</span> <span class=n>name</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>setId</span><span class=o>(</span><span class=kt>int</span> <span class=n>id</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=o>.</span><span class=na>id</span> <span class=o>=</span> <span class=n>id</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>setName</span><span class=o>(</span><span class=n>String</span> <span class=n>name</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=o>.</span><span class=na>name</span> <span class=o>=</span> <span class=n>name</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>//其他函数
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><p>此时，在配置xml时就如上文那样，数据注入是由set注入的，那么在类中就要写出属性的set方法</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;bean</span> <span class=na>id=</span><span class=s>&#34;user&#34;</span> <span class=na>class=</span><span class=s>&#34;com.hjc.pojo.User&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;property</span> <span class=na>name=</span><span class=s>&#34;id&#34;</span> <span class=na>value=</span><span class=s>&#34;1&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;property</span> <span class=na>name=</span><span class=s>&#34;name&#34;</span> <span class=na>value=</span><span class=s>&#34;admin&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/bean&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>用这种方式配置，那么对象是先由类的无参构造函数创建，再由类的set方法进行数据的注入，要注意这个先后顺序</p><h3 id=42-有参构造函数创建对象>4.2 有参构造函数创建对象<a hidden class=anchor aria-hidden=true href=#42-有参构造函数创建对象>#</a></h3><p>如果要使用有参构造函数创建对象，那么在类中就要写出有参构造函数。此时，数据是由有参构造函数注入</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>User</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kt>int</span> <span class=n>id</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>String</span> <span class=n>name</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=nf>User</span><span class=o>(</span><span class=kt>int</span> <span class=n>id</span><span class=o>,</span> <span class=n>String</span> <span class=n>name</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=o>.</span><span class=na>id</span> <span class=o>=</span> <span class=n>id</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=o>.</span><span class=na>name</span> <span class=o>=</span> <span class=n>name</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><p>在配置xml文件时就和上文不太一样</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;bean</span> <span class=na>id=</span><span class=s>&#34;user&#34;</span> <span class=na>class=</span><span class=s>&#34;com.hjc.pojo.User&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;constructor-arg</span> <span class=na>index=</span><span class=s>&#34;0&#34;</span> <span class=na>value=</span><span class=s>&#34;1&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;constructor-arg</span> <span class=na>index=</span><span class=s>&#34;1&#34;</span> <span class=na>value=</span><span class=s>&#34;admin&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/bean&gt;</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;bean</span> <span class=na>id=</span><span class=s>&#34;user&#34;</span> <span class=na>class=</span><span class=s>&#34;com.hjc.pojo.User&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;constructor-arg</span> <span class=na>type=</span><span class=s>&#34;int&#34;</span> <span class=na>value=</span><span class=s>&#34;1&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;constructor-arg</span> <span class=na>type=</span><span class=s>&#34;java.lang.String&#34;</span> <span class=na>value=</span><span class=s>&#34;admin&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/bean&gt;</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;bean</span> <span class=na>id=</span><span class=s>&#34;User&#34;</span> <span class=na>class=</span><span class=s>&#34;com.hjc.pojo.User&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;constructor-arg</span> <span class=na>name=</span><span class=s>&#34;id&#34;</span> <span class=na>value=</span><span class=s>&#34;1&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;constructor-arg</span> <span class=na>name=</span><span class=s>&#34;name&#34;</span> <span class=na>value=</span><span class=s>&#34;admin&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/bean&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>以上三种方法都可以实现相同的效果。以这种方式配置，对象就由类的有参构造函数创建，而数据也是由有参构造函数注入</p><p>不管对象是由无参构造函数还是有参构造函数创建的，在配置文件加载的时候，容器中的对象就已经被初始化了</p><h2 id=5-spring配置>5 Spring配置<a hidden class=anchor aria-hidden=true href=#5-spring配置>#</a></h2><h3 id=51-别名>5.1 别名<a hidden class=anchor aria-hidden=true href=#51-别名>#</a></h3><p>Spring中别名的使用和MyBatis中类似，使用别名之后可以省略类的包路径</p><h3 id=52-bean的配置>5.2 bean的配置<a hidden class=anchor aria-hidden=true href=#52-bean的配置>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=c>&lt;!--
</span></span></span><span class=line><span class=cl><span class=c>id: bean的唯一标识符
</span></span></span><span class=line><span class=cl><span class=c>class: bean对象对应的全限定名
</span></span></span><span class=line><span class=cl><span class=c>name: 别名，可以取多个别名
</span></span></span><span class=line><span class=cl><span class=c>scope: bean为单例还是多例
</span></span></span><span class=line><span class=cl><span class=c>--&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;bean</span> <span class=na>id=</span><span class=s>&#34;user&#34;</span> <span class=na>class=</span><span class=s>&#34;com.hjc.pojo.User&#34;</span> <span class=na>name=</span><span class=s>&#34;user2&#34;</span> <span class=na>scope=</span><span class=s>&#34;singleton&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;property</span> <span class=na>name=</span><span class=s>&#34;id&#34;</span> <span class=na>value=</span><span class=s>&#34;1&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;property</span> <span class=na>name=</span><span class=s>&#34;name&#34;</span> <span class=na>value=</span><span class=s>&#34;admin&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/bean&gt;</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=53-使用import>5.3 使用import<a hidden class=anchor aria-hidden=true href=#53-使用import>#</a></h3><p>将多个配置文件导入合并为一个配置文件。比如，在applicationContext.xml文件中导入service.xml和dao.xml配置文件，将这两个配置文件合并为一个applicationContext.xml配置文件</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;import</span> <span class=na>resource=</span><span class=s>&#34;service.xml&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;import</span> <span class=na>resource=</span><span class=s>&#34;dao.xml&#34;</span><span class=nt>/&gt;</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=6-依赖注入>6 依赖注入<a hidden class=anchor aria-hidden=true href=#6-依赖注入>#</a></h2><h3 id=61-构造器注入>6.1 构造器注入<a hidden class=anchor aria-hidden=true href=#61-构造器注入>#</a></h3><p>参考4.2</p><h3 id=62-set方式注入>6.2 set方式注入<a hidden class=anchor aria-hidden=true href=#62-set方式注入>#</a></h3><ul><li>依赖注入<ul><li>依赖：bean对象的创建依赖于容器</li><li>注入：bean对象的所有属性由容器注入</li></ul></li></ul><p>实例</p><ol><li>编写实体类</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Student</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>String</span> <span class=n>name</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>Address</span> <span class=n>address</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>String</span><span class=o>[]</span> <span class=n>books</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>List</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;</span> <span class=n>hobbies</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>Map</span><span class=o>&lt;</span><span class=n>String</span><span class=o>,</span> <span class=n>String</span><span class=o>&gt;</span> <span class=n>scores</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>Set</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;</span> <span class=n>games</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>String</span> <span class=n>nullPoint</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>Properties</span> <span class=n>info</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>//一定要写各属性的set方法，在此省略
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Address</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>String</span> <span class=n>address</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=nf>setAddress</span><span class=o>(</span><span class=n>String</span> <span class=n>address</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=o>.</span><span class=na>address</span> <span class=o>=</span> <span class=n>address</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><ol start=2><li>配置xml文件，使用set方法注入</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;bean</span> <span class=na>id=</span><span class=s>&#34;address&#34;</span> <span class=na>class=</span><span class=s>&#34;com.hjc.pojo.Address&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;property</span> <span class=na>name=</span><span class=s>&#34;address&#34;</span> <span class=na>value=</span><span class=s>&#34;testAddress&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/bean&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nt>&lt;bean</span> <span class=na>id=</span><span class=s>&#34;student&#34;</span> <span class=na>class=</span><span class=s>&#34;com.hjc.pojo.Student&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=c>&lt;!--基本类型（包括String）注入，value--&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;property</span> <span class=na>name=</span><span class=s>&#34;name&#34;</span> <span class=na>value=</span><span class=s>&#34;test&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=c>&lt;!--bean注入，ref--&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;property</span> <span class=na>name=</span><span class=s>&#34;address&#34;</span> <span class=na>ref=</span><span class=s>&#34;address&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=c>&lt;!--数组注入，--&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;property</span> <span class=na>name=</span><span class=s>&#34;books&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;array&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nt>&lt;value&gt;</span>testBook1<span class=nt>&lt;/value&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nt>&lt;value&gt;</span>testBook2<span class=nt>&lt;/value&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nt>&lt;value&gt;</span>testBook3<span class=nt>&lt;/value&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;/array&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;/property&gt;</span>
</span></span><span class=line><span class=cl>    <span class=c>&lt;!--list注入--&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;property</span> <span class=na>name=</span><span class=s>&#34;hobbies&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;list&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nt>&lt;value&gt;</span>testHobby1<span class=nt>&lt;/value&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nt>&lt;value&gt;</span>testHobby2<span class=nt>&lt;/value&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;/list&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;/property&gt;</span>
</span></span><span class=line><span class=cl>    <span class=c>&lt;!--map注入--&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;property</span> <span class=na>name=</span><span class=s>&#34;scores&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;map&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nt>&lt;entry</span> <span class=na>key=</span><span class=s>&#34;Math&#34;</span> <span class=na>value=</span><span class=s>&#34;100&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nt>&lt;entry</span> <span class=na>key=</span><span class=s>&#34;Physics&#34;</span> <span class=na>value=</span><span class=s>&#34;100&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;/map&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;/property&gt;</span>
</span></span><span class=line><span class=cl>    <span class=c>&lt;!--set注入--&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;property</span> <span class=na>name=</span><span class=s>&#34;games&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;set&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nt>&lt;value&gt;</span>testGame1<span class=nt>&lt;/value&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nt>&lt;value&gt;</span>testGame2<span class=nt>&lt;/value&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;/set&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;/property&gt;</span>
</span></span><span class=line><span class=cl>    <span class=c>&lt;!--null注入--&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;property</span> <span class=na>name=</span><span class=s>&#34;nullPoint&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;null/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;/property&gt;</span>
</span></span><span class=line><span class=cl>    <span class=c>&lt;!--properties注入--&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;property</span> <span class=na>name=</span><span class=s>&#34;info&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;props&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nt>&lt;prop</span> <span class=na>key=</span><span class=s>&#34;testInfo1&#34;</span><span class=nt>&gt;</span>test1<span class=nt>&lt;/prop&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nt>&lt;prop</span> <span class=na>key=</span><span class=s>&#34;testInfo2&#34;</span><span class=nt>&gt;</span>test2<span class=nt>&lt;/prop&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;/props&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;/property&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/bean&gt;</span>
</span></span></code></pre></td></tr></table></div></div><ol start=3><li>测试</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Test</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kt>void</span> <span class=nf>test</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>ApplicationContext</span> <span class=n>context</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ClassPathXmlApplicationContext</span><span class=o>(</span><span class=s>&#34;beans.xml&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>Student</span> <span class=n>student</span> <span class=o>=</span> <span class=o>(</span><span class=n>Student</span><span class=o>)</span> <span class=n>context</span><span class=o>.</span><span class=na>getBean</span><span class=o>(</span><span class=s>&#34;student&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>student</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=63-其他方式注入>6.3 其他方式注入<a hidden class=anchor aria-hidden=true href=#63-其他方式注入>#</a></h3><p>p命名空间，对应set注入，参考<a href=https://docs.spring.io/spring/docs/5.2.7.RELEASE/spring-framework-reference/core.html#beans-p-namespace>官方文档</a></p><p>c命名空间，对象构造器注入，参考<a href=https://docs.spring.io/spring/docs/5.2.7.RELEASE/spring-framework-reference/core.html#beans-c-namespace>官方文档</a></p><h2 id=7-bean的作用域>7 bean的作用域<a hidden class=anchor aria-hidden=true href=#7-bean的作用域>#</a></h2><h3 id=71-singleton>7.1 singleton<a hidden class=anchor aria-hidden=true href=#71-singleton>#</a></h3><p>单例模式，也是Spring的默认模式，不显示写出就表示单例</p><p>单例模式表示在容器中对象只会创建一个</p><h3 id=72-prototype>7.2 prototype<a hidden class=anchor aria-hidden=true href=#72-prototype>#</a></h3><p>原型模式，表示每次从容器中获得对象的时候，容器会创建一个新的对象返回</p><h3 id=73-requestsessionapplication>7.3 request、session、application<a hidden class=anchor aria-hidden=true href=#73-requestsessionapplication>#</a></h3><p>这几个在web开发中使用</p><h2 id=8-bean的自动装配>8 bean的自动装配<a hidden class=anchor aria-hidden=true href=#8-bean的自动装配>#</a></h2><p>之前的xml配置都是手动配置的，那么自动装配是Spring会在上下文中自动寻找，自动装配属性</p><p>在Spring中有三种装配的方式</p><ul><li>在xml中显示配置</li><li>在java类中显示配置</li><li>隐式自动装配</li></ul><h3 id=81-byname自动装配>8.1 byName自动装配<a hidden class=anchor aria-hidden=true href=#81-byname自动装配>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Student</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>String</span> <span class=n>name</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>Computer</span> <span class=n>computer</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>KeyBoard</span> <span class=n>keyBoard</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>//set方法
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Computer</span> <span class=o>{</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>KeyBoard</span> <span class=o>{</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><p>有三个实体类，用byName自动装配配置xml</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;bean</span> <span class=na>id=</span><span class=s>&#34;computer&#34;</span> <span class=na>class=</span><span class=s>&#34;com.hjc.pojo.Computer&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;bean</span> <span class=na>id=</span><span class=s>&#34;keyBoard&#34;</span> <span class=na>class=</span><span class=s>&#34;com.hjc.pojo.KeyBoard&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl><span class=c>&lt;!--
</span></span></span><span class=line><span class=cl><span class=c>byName: 自动在容器上下文中查找和自己对象set方法后面的值对应的bean id
</span></span></span><span class=line><span class=cl><span class=c>如：类中setComputer方法，Computer对应bean id为computer
</span></span></span><span class=line><span class=cl><span class=c>--&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;bean</span> <span class=na>id=</span><span class=s>&#34;student&#34;</span> <span class=na>class=</span><span class=s>&#34;com.hjc.pojo.Student&#34;</span> <span class=na>autowire=</span><span class=s>&#34;byName&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;property</span> <span class=na>name=</span><span class=s>&#34;name&#34;</span> <span class=na>value=</span><span class=s>&#34;test&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/bean&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>这种方法要求bean的id不能随便选择，要和自动注入的属性的set方法的值一致，除了首字母大写变成小写</p><h3 id=82-bytype自动装配>8.2 byType自动装配<a hidden class=anchor aria-hidden=true href=#82-bytype自动装配>#</a></h3><p>还是上面三个实体类，用byType实现自动装配</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;bean</span> <span class=na>id=</span><span class=s>&#34;computer&#34;</span> <span class=na>class=</span><span class=s>&#34;com.hjc.pojo.Computer&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;bean</span> <span class=na>id=</span><span class=s>&#34;keyBoard&#34;</span> <span class=na>class=</span><span class=s>&#34;com.hjc.pojo.KeyBoard&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl><span class=c>&lt;!--
</span></span></span><span class=line><span class=cl><span class=c>byType: 会自动在容器上下文中查找和自己对象属性类型相同的bean
</span></span></span><span class=line><span class=cl><span class=c>--&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;bean</span> <span class=na>id=</span><span class=s>&#34;student&#34;</span> <span class=na>class=</span><span class=s>&#34;com.hjc.pojo.Student&#34;</span> <span class=na>autowire=</span><span class=s>&#34;byType&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;property</span> <span class=na>name=</span><span class=s>&#34;name&#34;</span> <span class=na>value=</span><span class=s>&#34;test&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/bean&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>这种方法要求对象中属性类型要唯一，如果有几个相同的属性类型，就不能自动装配</p><h3 id=83-注解自动装配>8.3 注解自动装配<a hidden class=anchor aria-hidden=true href=#83-注解自动装配>#</a></h3><p>jdk1.5支持注解，spring2.5支持注解</p><p>要使用注解</p><ol><li>导入约束，context约束</li><li>配置注解的支持</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;context:annotation-config/&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>使用@Autowired注解，直接在属性上使用，或者在set方法上使用。另外，使用@Autowired注解可以不写set方法，前提是属性符合byType的要求</p><p>实体类</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Student</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>String</span> <span class=n>name</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=nd>@Autowired</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>Computer</span> <span class=n>computer</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=nd>@Autowired</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>KeyBoard</span> <span class=n>keyBoard</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>//set方法
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><p>xml文件</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;bean</span> <span class=na>id=</span><span class=s>&#34;computer&#34;</span> <span class=na>class=</span><span class=s>&#34;com.hjc.pojo.Computer&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;bean</span> <span class=na>id=</span><span class=s>&#34;keyBoard&#34;</span> <span class=na>class=</span><span class=s>&#34;com.hjc.pojo.KeyBoard&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;bean</span> <span class=na>id=</span><span class=s>&#34;student&#34;</span> <span class=na>class=</span><span class=s>&#34;com.hjc.pojo.Student&#34;</span><span class=nt>/&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>如果使用@Autowired实现自动装配的环境比较复杂，无法通过一个注解完成的时候，可以配合使用@Qualifier(value=&ldquo;xxx&rdquo;)来指定唯一的一个bean</p><h2 id=9-使用注解开发>9 使用注解开发<a hidden class=anchor aria-hidden=true href=#9-使用注解开发>#</a></h2><p>在Spring4之后，要使用注解开发，必须要导入aop的包。另外，需要在xml文件中导入context约束，配置注解的支持</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;context:annotation-config/&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>首先，要配置扫描的包，也就是说，在类中配置了注解还要被扫描到才有效</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;context:component-scan</span> <span class=na>base-package=</span><span class=s>&#34;com.hjc&#34;</span><span class=nt>/&gt;</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=91-component>9.1 @Component<a hidden class=anchor aria-hidden=true href=#91-component>#</a></h3><p>这个注解放在类上，表示这个类被Spring管理了，比如</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Component</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>User</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>//省略
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><p>相当于在xml文件中配置bean</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;bean</span> <span class=na>id=</span><span class=s>&#34;user&#34;</span> <span class=na>class=</span><span class=s>&#34;com.hjc.pojo.User&#34;</span><span class=nt>/&gt;</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=92-value>9.2 @Value<a hidden class=anchor aria-hidden=true href=#92-value>#</a></h3><p>这个注解放在类中的属性上，表示注入数据，比如</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Component</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>User</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=nd>@Value</span><span class=o>(</span><span class=s>&#34;test&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>String</span> <span class=n>name</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><p>相当于在xml文件中配置bean，并进行依赖注入</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;bean</span> <span class=na>id=</span><span class=s>&#34;user&#34;</span> <span class=na>class=</span><span class=s>&#34;com.hjc.pojo.User&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;property</span> <span class=na>name=</span><span class=s>&#34;name&#34;</span> <span class=na>value=</span><span class=s>&#34;test&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/bean&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>@Value注解也可以放在属性的对应set方法上，但这个注解只能进行简单的配置，复杂的配置还是使用xml文件</p><h3 id=93-component的衍生注解>9.3 @Component的衍生注解<a hidden class=anchor aria-hidden=true href=#93-component的衍生注解>#</a></h3><p>web项目一般有三层，不同层中的注解名称不同，但作用相同</p><ul><li>Dao层：@Repository</li><li>Service层：@Service</li><li>Controller层：@Controller</li></ul><p>这几个注解和@Component是一样的，都表示将类注册到Spring中，装配bean</p><h3 id=94-autowired>9.4 @Autowired<a hidden class=anchor aria-hidden=true href=#94-autowired>#</a></h3><p>这个注解实现自动装配，参考8.3</p><h3 id=95-scope>9.5 @Scope<a hidden class=anchor aria-hidden=true href=#95-scope>#</a></h3><p>这个注解配置类的作用域，是单例模式还是原型模式，比如</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Component</span>
</span></span><span class=line><span class=cl><span class=nd>@Scope</span><span class=o>(</span><span class=s>&#34;singleton&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>User</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=nd>@Value</span><span class=o>(</span><span class=s>&#34;test&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>String</span> <span class=n>name</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><p>总结：</p><ul><li>xml文件配置更加万能，适用于任何场合，维护简单</li><li>注解适用于简单的配置，维护相对复杂</li><li>项目中一般<strong>使用xml管理bean，使用注解完成属性注入</strong></li></ul><h2 id=10-使用javaconfig配置>10 使用JavaConfig配置<a hidden class=anchor aria-hidden=true href=#10-使用javaconfig配置>#</a></h2><p>不使用xml文件配置，都由Java代码配置</p><p>JavaConfig是Spring的一个子项目，在Spring4之后，称为一个核心功能</p><h3 id=101-configurationbean>10.1 @Configuration、@Bean<a hidden class=anchor aria-hidden=true href=#101-configurationbean>#</a></h3><p>要用Java代码进行配置，就要用到@Configuration和@Bean这两个注解，比如</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Configuration</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>AppConfig</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=nd>@Bean</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>User</span> <span class=nf>getUser</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=k>new</span> <span class=n>User</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><p>这就相当于在xml中配置</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;bean</span> <span class=na>id=</span><span class=s>&#34;getUser&#34;</span> <span class=na>class=</span><span class=s>&#34;com.hjc.pojo.User&#34;</span><span class=nt>/&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>测试</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Test</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kt>void</span> <span class=nf>test</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>ApplicationContext</span> <span class=n>context</span> <span class=o>=</span> <span class=k>new</span> <span class=n>AnnotationConfigApplicationContext</span><span class=o>(</span><span class=n>AppConfig</span><span class=o>.</span><span class=na>class</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>User</span> <span class=n>user</span> <span class=o>=</span> <span class=n>context</span><span class=o>.</span><span class=na>getBean</span><span class=o>(</span><span class=s>&#34;getUser&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><p>注意和xml文件配置实例化对象的不同</p><h3 id=102-componentscan>10.2 @ComponentScan<a hidden class=anchor aria-hidden=true href=#102-componentscan>#</a></h3><p>在配置类中使用这个注解表示设置扫描类包</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Configuration</span>
</span></span><span class=line><span class=cl><span class=nd>@ComponentScan</span><span class=o>(</span><span class=s>&#34;com.hjc&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>AppConfig</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=nd>@Bean</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>User</span> <span class=nf>getUser</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=k>new</span> <span class=n>User</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=11-代理模式>11 代理模式<a hidden class=anchor aria-hidden=true href=#11-代理模式>#</a></h2><p>代理模式是SpringAOP的底层实现</p><p>代理模式有两种</p><ul><li>静态代理</li><li>动态代理</li></ul><h3 id=111-静态代理>11.1 静态代理<a hidden class=anchor aria-hidden=true href=#111-静态代理>#</a></h3><p><img loading=lazy src=%e4%bb%a3%e7%90%86%e6%a8%a1%e5%bc%8f.png alt></p><p>角色分析</p><ul><li>抽象角色：一般会使用接口或者抽象类来解决</li><li>真实角色：被代理角色</li><li>代理角色：代理真实角色，代理真实角色后，一般会做附加操作</li><li>客户：访问代理对象的人</li></ul><p>使用静态代理的例子</p><ol><li>编写接口（抽象角色）</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>//租房接口
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>public</span> <span class=kd>interface</span> <span class=nc>Rent</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>void</span> <span class=nf>rent</span><span class=o>();</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><ol start=2><li>编写被代理类（真实角色）</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>//房东
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Host</span> <span class=kd>implements</span> <span class=n>Rent</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>rent</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;房东出租房子&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><ol start=3><li>编写代理类（代理角色）</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Proxy</span> <span class=kd>implements</span> <span class=n>Rent</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>Host</span> <span class=n>host</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=nf>Proxy</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=nf>Proxy</span><span class=o>(</span><span class=n>Host</span> <span class=n>host</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=o>.</span><span class=na>host</span> <span class=o>=</span> <span class=n>host</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>rent</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>findHouse</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=n>host</span><span class=o>.</span><span class=na>rent</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=n>signContract</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>findHouse</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;找到房子&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>signContract</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;签合同&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><ol start=4><li>编写客户访问代理角色</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Client</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>Proxy</span> <span class=n>proxy</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Proxy</span><span class=o>(</span><span class=k>new</span> <span class=n>Host</span><span class=o>());</span>
</span></span><span class=line><span class=cl>        <span class=n>proxy</span><span class=o>.</span><span class=na>rent</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><p>静态代理的好处：</p><ul><li>可以使真实角色的操作更加纯粹，不用关注一些公共的业务</li><li>公共业务交给代理角色，实现了业务的分工</li><li>公共业务发生扩展的时候，方便集中管理</li></ul><p>缺点：</p><ul><li>一个真实角色就会产生一个代理角色，增加代码量，开发效率低</li></ul><p>在web开发中，如果要对类中的方法进行增强，直接改类中对应方法的代码比较繁琐，而且实际开发不允许直接改代码，我们可以使用静态代理实现，举个例子加深理解</p><ol><li>编写service接口</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>interface</span> <span class=nc>UserService</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>void</span> <span class=nf>add</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=kt>void</span> <span class=nf>delete</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=kt>void</span> <span class=nf>update</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=kt>void</span> <span class=nf>query</span><span class=o>();</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><ol start=2><li>编写service实现类</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>UserServiceImpl</span> <span class=kd>implements</span> <span class=n>UserService</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>//实现对应方法
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><ol start=3><li>编写代理类</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>UserServiceProxy</span> <span class=kd>implements</span> <span class=n>UserService</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>UserService</span> <span class=n>userService</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>setUserService</span><span class=o>(</span><span class=n>UserService</span> <span class=n>userService</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=o>.</span><span class=na>userService</span> <span class=o>=</span> <span class=n>userService</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>add</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>log</span><span class=o>(</span><span class=s>&#34;add&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>userService</span><span class=o>.</span><span class=na>add</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>delete</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>log</span><span class=o>(</span><span class=s>&#34;delete&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>userService</span><span class=o>.</span><span class=na>delete</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>update</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>log</span><span class=o>(</span><span class=s>&#34;update&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>userService</span><span class=o>.</span><span class=na>update</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>query</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>log</span><span class=o>(</span><span class=s>&#34;query&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>userService</span><span class=o>.</span><span class=na>find</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>log</span><span class=o>(</span><span class=n>String</span> <span class=n>msg</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;[debug] 使用了&#34;</span> <span class=o>+</span> <span class=n>msg</span> <span class=o>+</span> <span class=s>&#34;方法&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><ol start=4><li>客户访问</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Client</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>UserServiceProxy</span> <span class=n>proxy</span> <span class=o>=</span> <span class=k>new</span> <span class=n>UserServiceProxy</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=n>proxy</span><span class=o>.</span><span class=na>setUserService</span><span class=o>(</span><span class=k>new</span> <span class=n>UserServiceImpl</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>proxy</span><span class=o>.</span><span class=na>add</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=n>proxy</span><span class=o>.</span><span class=na>delete</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=n>proxy</span><span class=o>.</span><span class=na>update</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=n>proxy</span><span class=o>.</span><span class=na>query</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><p>这样子就避免修改了原有的service代码，而是通过代理类对service类的方法进行增强</p><p><img loading=lazy src=%e6%a8%aa%e5%90%91%e5%bc%80%e5%8f%91.png alt></p><h3 id=112-动态代理>11.2 动态代理<a hidden class=anchor aria-hidden=true href=#112-动态代理>#</a></h3><ul><li>动态代理和静态代理的角色一样</li><li>动态代理的代理类是动态生成的，不是直接写好的</li><li>动态代理分为两大类<ul><li>基于接口的动态代理：jdk动态代理</li><li>基于类的动态代理：cglib</li><li>还有基于java字节码实现：Javassist</li></ul></li></ul><p>需要了解两个类：Proxy，InvocationHandler</p><p>动态代理的好处</p><ul><li>动态代理有静态代理的优点</li><li>另外，一个动态代理类代理的是一个接口，一般对应一类业务，解决了静态代理的缺点</li></ul><h2 id=12-aop>12 AOP<a hidden class=anchor aria-hidden=true href=#12-aop>#</a></h2><h3 id=121aop定义>12.1AOP定义<a hidden class=anchor aria-hidden=true href=#121aop定义>#</a></h3><p>AOP（Aspect Oriented Programming），面向切面编程，通过预编译方式和运行期动态代理实现程序功能统一维护的技术。AOP是OOP的延续，是函数式编程的一种衍生范型</p><h3 id=122-aop在spring中的作用>12.2 AOP在Spring中的作用<a hidden class=anchor aria-hidden=true href=#122-aop在spring中的作用>#</a></h3><p>提供声明式事务，允许用户自定义切面</p><ul><li>横切关注点：跨越应用程序多个模块的方法或功能，如日志，安全，缓存，事务等等</li><li>切面（Aspect）：横切关注点被模块化的特殊对象，即是一个类</li><li>通知（Advice）：切面必须要完成的工作，即是类中的一个方法</li><li>目标（Target）：被通知对象</li><li>代理（Proxy）：向目标对象应用通知之后创建的对象</li><li>切入点（PointCut）：切面通知执行的“地点”</li><li>连接点（JointPoint）：与切入点匹配的执行点</li></ul><p><img loading=lazy src=AOP.png alt></p><p>SpringAOP中，通过Advice定义横切逻辑，Spring支持5种类型的Advice</p><ul><li>前置通知<ul><li>连接点：方法前</li><li>实现接口：org.springframework.aop.MethodBeforeAdvice</li></ul></li><li>后置通知<ul><li>连接点：方法后</li><li>实现接口：org.springframework.aop.AfterReturningAdvice</li></ul></li><li>环绕通知<ul><li>连接点：方法前后</li><li>实现接口：org.aopalliance.intercept.MethodInterceptor</li></ul></li><li>异常抛出通知<ul><li>连接点：方法抛出异常</li><li>实现接口：org.springframework.aop.ThrowsAdvice</li></ul></li><li>引介通知<ul><li>连接点：类中增加新的方法属性</li><li>实现接口：org.springframework.aop.IntroductionInterceptor</li></ul></li></ul><p>AOP在不改变原有代码的情况下， 增加新的功能</p><h3 id=113-使用spring实现aop>11.3 使用Spring实现AOP<a hidden class=anchor aria-hidden=true href=#113-使用spring实现aop>#</a></h3><p>要使用AOP织入，需要导入包</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;dependency&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;groupId&gt;</span>org.aspectj<span class=nt>&lt;/groupId&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;artifactId&gt;</span>aspectjweaver<span class=nt>&lt;/artifactId&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;version&gt;</span>1.9.5<span class=nt>&lt;/version&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/dependency&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>假设有service接口和实现类</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>interface</span> <span class=nc>UserService</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>void</span> <span class=nf>add</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=kt>void</span> <span class=nf>delete</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=kt>void</span> <span class=nf>update</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=kt>void</span> <span class=nf>query</span><span class=o>();</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>UserServiceImpl</span> <span class=kd>implements</span> <span class=n>UserService</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>//实现对应方法
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><p>那么，要对这几个方法使用AOP进行方法增强</p><p><strong>方式一：使用Spring的API实现</strong></p><ol><li>首先要定义切面和通知，定义类实现对应接口</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>BeforeLog</span> <span class=kd>implements</span> <span class=n>MethodBeforeAdvice</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>//Method: 被代理的目标对象的方法
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>//args: 方法参数
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>//target: 被代理的目标对象
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>before</span><span class=o>(</span><span class=n>Method</span> <span class=n>method</span><span class=o>,</span> <span class=n>Object</span><span class=o>[]</span> <span class=n>args</span><span class=o>,</span> <span class=n>Object</span> <span class=n>target</span><span class=o>)</span> <span class=kd>throws</span> <span class=n>Throwable</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;执行&#34;</span> <span class=o>+</span> <span class=n>target</span><span class=o>.</span><span class=na>getClass</span><span class=o>().</span><span class=na>getName</span><span class=o>()</span> <span class=o>+</span> <span class=s>&#34;的&#34;</span> <span class=o>+</span> <span class=n>method</span><span class=o>.</span><span class=na>getName</span><span class=o>());</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>AfterLog</span> <span class=kd>implements</span> <span class=n>AfterReturningAdvice</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>//returnValue: 被代理的方法的返回值
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>afterReturning</span><span class=o>(</span><span class=n>Object</span> <span class=n>returnValue</span><span class=o>,</span> <span class=n>Method</span> <span class=n>method</span><span class=o>,</span> <span class=n>Object</span><span class=o>[]</span> <span class=n>args</span><span class=o>,</span> <span class=n>Object</span> <span class=n>target</span><span class=o>)</span> <span class=kd>throws</span> <span class=n>Throwable</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;执行&#34;</span> <span class=o>+</span> <span class=n>method</span><span class=o>.</span><span class=na>getName</span><span class=o>()</span> <span class=o>+</span> <span class=s>&#34;返回结果&#34;</span> <span class=o>+</span> <span class=n>returnValue</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><ol start=2><li>在xml中配置，把这些类注册到Spring中</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=c>&lt;!--注册bean--&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;bean</span> <span class=na>id=</span><span class=s>&#34;userService&#34;</span> <span class=na>class=</span><span class=s>&#34;com.hjc.service.UserServiceImpl&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;bean</span> <span class=na>id=</span><span class=s>&#34;beforeLog&#34;</span> <span class=na>class=</span><span class=s>&#34;com.hjc.log.BeforeLog&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;bean</span> <span class=na>id=</span><span class=s>&#34;afterLog&#34;</span> <span class=na>class=</span><span class=s>&#34;com.hjc.log.AfterLog&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c>&lt;!--配置aop，导入aop约束--&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;aop:config&gt;</span>
</span></span><span class=line><span class=cl>    <span class=c>&lt;!--切入点，expression表达式--&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;aop:pointcut</span> <span class=na>id=</span><span class=s>&#34;pointcut&#34;</span> <span class=na>expression=</span><span class=s>&#34;execution(* com.hjc.service.UserServiceImpl.*(..))&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=c>&lt;!--执行增强--&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;aop:advisor</span> <span class=na>advice-ref=</span><span class=s>&#34;beforeLog&#34;</span> <span class=na>pointcut-ref=</span><span class=s>&#34;pointcut&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;aop:advisor</span> <span class=na>advice-ref=</span><span class=s>&#34;afterLog&#34;</span> <span class=na>pointcut-ref=</span><span class=s>&#34;pointcut&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/aop:config&gt;</span>
</span></span></code></pre></td></tr></table></div></div><ol start=3><li>测试</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Test</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kt>void</span> <span class=nf>test</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>ApplicationContext</span> <span class=n>context</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ClassPathXmlApplicationContext</span><span class=o>(</span><span class=s>&#34;applicationContext.xml&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=c1>//动态代理的是接口
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>UserService</span> <span class=n>userService</span> <span class=o>=</span> <span class=o>(</span><span class=n>UserService</span><span class=o>)</span> <span class=n>context</span><span class=o>.</span><span class=na>getBean</span><span class=o>(</span><span class=s>&#34;userService&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>userService</span><span class=o>.</span><span class=na>add</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=n>userService</span><span class=o>.</span><span class=na>delete</span><span class=o>();</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>方式二：自定义实现AOP</strong></p><p>不通过实现Spring的接口来实现AOP，而是自己定义切面类和通知</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>MyLog</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>beforeLog</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>//具体实现
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>AfterLog</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>//具体实现
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><p>同样，在xml中配置</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;bean</span> <span class=na>id=</span><span class=s>&#34;myLog&#34;</span> <span class=na>class=</span><span class=s>&#34;com.hjc.log.MyLog&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nt>&lt;aop:config&gt;</span>
</span></span><span class=line><span class=cl>    <span class=c>&lt;!--自定义切面--&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;aop:aspect</span> <span class=na>ref=</span><span class=s>&#34;myLog&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=c>&lt;!--切入点--&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;aop:pointcut</span> <span class=na>id=</span><span class=s>&#34;pointcut&#34;</span> <span class=na>expression=</span><span class=s>&#34;execution(* com.hjc.service.UserServiceImpl.*(..))&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>        <span class=c>&lt;!--通知--&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;aop:before</span> <span class=na>method=</span><span class=s>&#34;beforeLog&#34;</span> <span class=na>pointcut-ref=</span><span class=s>&#34;pointcut&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;aop:after</span> <span class=na>method=</span><span class=s>&#34;afterLog&#34;</span> <span class=na>pointcut-ref=</span><span class=s>&#34;pointcut&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;/aop:aspect&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/aop:config&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>方式三：注解实现AOP</strong></p><p>使用注解实现AOP，主要是在定义切面类的时候使用注解</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Aspect</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>MyLog</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=nd>@Before</span><span class=o>(</span><span class=s>&#34;execution(* com.hjc.service.UserServiceImpl.*(..))&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>before</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>//具体实现
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nd>@After</span><span class=o>(</span><span class=s>&#34;execution(* com.hjc.service.UserServiceImpl.*(..))&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>after</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>//具体实现
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><p>在xml中只需注册bean，当然也可以使用注解自动装配。还要开启注解支持</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;bean</span> <span class=na>id=</span><span class=s>&#34;myLog&#34;</span> <span class=na>class=</span><span class=s>&#34;com.hjc.log.MyLog&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;aop:aspectj-autoproxy/&gt;</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=13-整合mybatis>13 整合MyBatis<a hidden class=anchor aria-hidden=true href=#13-整合mybatis>#</a></h2><p>步骤</p><ol><li>导入相关jar包<ul><li>junit</li><li>mybatis</li><li>mysql</li><li>spring</li><li>aop织入</li><li>mybatis-spring</li></ul></li><li>编写配置文件</li></ol><h3 id=131-mybatis>13.1 MyBatis<a hidden class=anchor aria-hidden=true href=#131-mybatis>#</a></h3><h3 id=132-mybatis-spring>13.2 MyBatis-Spring<a hidden class=anchor aria-hidden=true href=#132-mybatis-spring>#</a></h3><p>参考<a href=https://mybatis.org/spring/zh/index.html>官方文档</a></p><ol><li>编写数据源配置</li><li>sqlSessionFactory</li><li>sqlSessionTemplate</li><li>给Dao接口编写实现类</li><li>注册实现类到Spring中</li><li>测试</li></ol><h2 id=14-声明式事务>14 声明式事务<a hidden class=anchor aria-hidden=true href=#14-声明式事务>#</a></h2><h2 id=141-事务>14.1 事务<a hidden class=anchor aria-hidden=true href=#141-事务>#</a></h2><ul><li>事务涉及数据的完整性和一致性问题</li><li>事务ACID原则<ul><li>原子性</li><li>一致性</li><li>隔离性</li><li>持久性</li></ul></li></ul><h3 id=142-spring中的事务管理>14.2 Spring中的事务管理<a hidden class=anchor aria-hidden=true href=#142-spring中的事务管理>#</a></h3><ul><li>声明式事务：AOP</li><li>编程式事务：在代码中进行事务管理</li></ul><p>一般使用声明式事务，而不是用编程式事务，因为编程式事务会改变代码</p><ol><li>在xml中配置声明式事务</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;bean</span> <span class=na>id=</span><span class=s>&#34;transactionManager&#34;</span> <span class=na>class=</span><span class=s>&#34;org.springframework.jdbc.datasource.DataSourceTransactionManager&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;property</span> <span class=na>name=</span><span class=s>&#34;dataSource&#34;</span> <span class=na>value=</span><span class=s>&#34;dataSource&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/bean&gt;</span>
</span></span></code></pre></td></tr></table></div></div><ol start=2><li>结合AOP实现事务织入</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=c>&lt;!--配置事务通知--&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;tx:advice</span> <span class=na>id=</span><span class=s>&#34;txAdvice&#34;</span> <span class=na>transaction-manager=</span><span class=s>&#34;transactionManager&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=c>&lt;!--给具体方法配置事务--&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;tx:attributes&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;tx:method</span> <span class=na>name=</span><span class=s>&#34;add&#34;</span> <span class=na>propagation=</span><span class=s>&#34;REQUIRED&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;tx:method</span> <span class=na>name=</span><span class=s>&#34;delete&#34;</span> <span class=na>propagation=</span><span class=s>&#34;REQUIRED&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;tx:method</span> <span class=na>name=</span><span class=s>&#34;update&#34;</span> <span class=na>propagation=</span><span class=s>&#34;REQUIRED&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;tx:method</span> <span class=na>name=</span><span class=s>&#34;query&#34;</span> <span class=na>read-only=</span><span class=s>&#34;true&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>        <span class=c>&lt;!--配置所有方法--&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;tx:method</span> <span class=na>name=</span><span class=s>&#34;*&#34;</span> <span class=na>propagation=</span><span class=s>&#34;REQUIRED&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;/tx:attributes&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/tx:advice&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c>&lt;!--配置事务切入--&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;aop:config&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;aop:pointcut</span> <span class=na>id=</span><span class=s>&#34;txPointCut&#34;</span> <span class=na>expression=</span><span class=s>&#34;execution(* com.hjc.mapper.*.*(..))&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;aop:advisor</span> <span class=na>advice-ref=</span><span class=s>&#34;txAdvice&#34;</span> <span class=na>pointcut-ref=</span><span class=s>&#34;txPointCut&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/aop:config&gt;</span>
</span></span></code></pre></td></tr></table></div></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://h-jch.github.io/tags/java/>java</a></li><li><a href=https://h-jch.github.io/tags/spring/>spring</a></li></ul><nav class=paginav><a class=prev href=https://h-jch.github.io/posts/code/study-springmvc/><span class=title>« Prev</span><br><span>SpringMVC学习笔记</span></a>
<a class=next href=https://h-jch.github.io/posts/code/study-mybatis/><span class=title>Next »</span><br><span>MyBatis学习笔记</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://h-jch.github.io>Kei's Blog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>